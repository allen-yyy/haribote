     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_GetMyObj
     7 00000000                                 	EXTERN	_dDevs
     8 00000000                                 	EXTERN	_message_send
     9 00000000                                 	EXTERN	_message_receive
    10 00000000                                 	EXTERN	_boxfill8
    11 00000000                                 	EXTERN	_sprintf
    12 00000000                                 	EXTERN	_putfonts8_asc
    13 00000000                                 	EXTERN	_task_alloc
    14 00000000                                 	EXTERN	_memman_alloc_4k
    15 00000000                                 	EXTERN	_task_run
    16 00000000                                 [FILE "fs.c"]
    17                                          [SECTION .data]
    18 00000000                                 LC0:
    19 00000000 46 53 00                        	DB	"FS",0x00
    20 00000003                                 LC1:
    21 00000003 49 64 65 20 48 44 00            	DB	"Ide HD",0x00
    22 0000000A                                 LC2:
    23 0000000A 66 73 20 74 61 73 6B 72 75 6E   	DB	"fs taskrun %d",0x00
       00000014 20 25 64 00 
    24                                          [SECTION .text]
    25 00000000                                 	GLOBAL	_FS_task
    26 00000000                                 _FS_task:
    27 00000000 55                              	PUSH	EBP
    28 00000001 89 E5                           	MOV	EBP,ESP
    29 00000003 56                              	PUSH	ESI
    30 00000004 53                              	PUSH	EBX
    31 00000005 83 EC 20                        	SUB	ESP,32
    32 00000008 68 [00000000]                   	PUSH	LC0
    33 0000000D E8 [00000000]                   	CALL	_GetMyObj
    34 00000012 68 [00000003]                   	PUSH	LC1
    35 00000017 E8 [00000000]                   	CALL	_GetMyObj
    36 0000001C A1 [00000008]                   	MOV	EAX,DWORD [_dDevs+8]
    37 00000021 53                              	PUSH	EBX
    38 00000022 C7 03 00000001                  	MOV	DWORD [EBX],1
    39 00000028 FF 70 08                        	PUSH	DWORD [8+EAX]
    40 0000002B E8 [00000000]                   	CALL	_message_send
    41 00000030 53                              	PUSH	EBX
    42 00000031 68 00002710                     	PUSH	10000
    43 00000036 89 C6                           	MOV	ESI,EAX
    44 00000038 E8 [00000000]                   	CALL	_message_receive
    45 0000003D                                 L5:
    46 0000003D 83 C4 18                        	ADD	ESP,24
    47 00000040 6A 0F                           	PUSH	15
    48 00000042 68 000000FF                     	PUSH	255
    49 00000047 8D 5D D8                        	LEA	EBX,DWORD [-40+EBP]
    50 0000004A 6A 00                           	PUSH	0
    51 0000004C 6A 00                           	PUSH	0
    52 0000004E 6A 00                           	PUSH	0
    53 00000050 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    54 00000057 50                              	PUSH	EAX
    55 00000058 FF 35 00000FF8                  	PUSH	DWORD [4088]
    56 0000005E E8 [00000000]                   	CALL	_boxfill8
    57 00000063 56                              	PUSH	ESI
    58 00000064 68 [0000000A]                   	PUSH	LC2
    59 00000069 53                              	PUSH	EBX
    60 0000006A E8 [00000000]                   	CALL	_sprintf
    61 0000006F 83 C4 28                        	ADD	ESP,40
    62 00000072 53                              	PUSH	EBX
    63 00000073 6A 07                           	PUSH	7
    64 00000075 6A 00                           	PUSH	0
    65 00000077 6A 00                           	PUSH	0
    66 00000079 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    67 00000080 50                              	PUSH	EAX
    68 00000081 FF 35 00000FF8                  	PUSH	DWORD [4088]
    69 00000087 E8 [00000000]                   	CALL	_putfonts8_asc
    70 0000008C EB AF                           	JMP	L5
    71 0000008E                                 	GLOBAL	_FSEntry
    72 0000008E                                 _FSEntry:
    73 0000008E 55                              	PUSH	EBP
    74 0000008F 89 E5                           	MOV	EBP,ESP
    75 00000091 56                              	PUSH	ESI
    76 00000092 53                              	PUSH	EBX
    77 00000093 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    78 00000096 E8 [00000000]                   	CALL	_task_alloc
    79 0000009B 68 00010000                     	PUSH	65536
    80 000000A0 89 C3                           	MOV	EBX,EAX
    81 000000A2 FF 76 04                        	PUSH	DWORD [4+ESI]
    82 000000A5 E8 [00000000]                   	CALL	_memman_alloc_4k
    83 000000AA 05 00010000                     	ADD	EAX,65536
    84 000000AF 89 43 64                        	MOV	DWORD [100+EBX],EAX
    85 000000B2 C7 43 4C [00000000]             	MOV	DWORD [76+EBX],_FS_task
    86 000000B9 C7 43 74 00000008               	MOV	DWORD [116+EBX],8
    87 000000C0 C7 43 78 00000010               	MOV	DWORD [120+EBX],16
    88 000000C7 C7 43 7C 00000008               	MOV	DWORD [124+EBX],8
    89 000000CE C7 83 00000080 00000008         	MOV	DWORD [128+EBX],8
    90 000000D8 C7 83 00000084 00000008         	MOV	DWORD [132+EBX],8
    91 000000E2 C7 83 00000088 00000008         	MOV	DWORD [136+EBX],8
    92 000000EC 6A 02                           	PUSH	2
    93 000000EE 6A 03                           	PUSH	3
    94 000000F0 53                              	PUSH	EBX
    95 000000F1 E8 [00000000]                   	CALL	_task_run
    96 000000F6 B8 00000001                     	MOV	EAX,1
    97 000000FB 89 5E 08                        	MOV	DWORD [8+ESI],EBX
    98 000000FE 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    99 00000101 5B                              	POP	EBX
   100 00000102 5E                              	POP	ESI
   101 00000103 5D                              	POP	EBP
   102 00000104 C3                              	RET
