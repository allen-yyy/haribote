     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_GetMyObj
     7 00000000                                 	EXTERN	_message_send
     8 00000000                                 	EXTERN	_message_receive
     9 00000000                                 	EXTERN	_io_hlt
    10 00000000                                 	EXTERN	_boxfill8
    11 00000000                                 	EXTERN	_sprintf
    12 00000000                                 	EXTERN	_putfonts8_asc
    13 00000000                                 	EXTERN	_task_alloc
    14 00000000                                 	EXTERN	_memman_alloc_4k
    15 00000000                                 	EXTERN	_task_run
    16 00000000                                 [FILE "fs.c"]
    17                                          [SECTION .data]
    18 00000000                                 LC0:
    19 00000000 46 53 00                        	DB	"FS",0x00
    20 00000003                                 LC1:
    21 00000003 49 64 65 20 48 44 00            	DB	"Ide HD",0x00
    22 0000000A                                 LC2:
    23 0000000A 74 61 73 6B 72 75 6E 20 25 64   	DB	"taskrun %d",0x00
       00000014 00 
    24                                          [SECTION .text]
    25 00000000                                 	GLOBAL	_FS_task
    26 00000000                                 _FS_task:
    27 00000000 55                              	PUSH	EBP
    28 00000001 89 E5                           	MOV	EBP,ESP
    29 00000003 56                              	PUSH	ESI
    30 00000004 53                              	PUSH	EBX
    31 00000005 31 F6                           	XOR	ESI,ESI
    32 00000007 83 EC 20                        	SUB	ESP,32
    33 0000000A 68 [00000000]                   	PUSH	LC0
    34 0000000F E8 [00000000]                   	CALL	_GetMyObj
    35 00000014 68 [00000003]                   	PUSH	LC1
    36 00000019 E8 [00000000]                   	CALL	_GetMyObj
    37 0000001E 53                              	PUSH	EBX
    38 0000001F C7 03 00000001                  	MOV	DWORD [EBX],1
    39 00000025 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
    40 00000028 FF B0 0000012C                  	PUSH	DWORD [300+EAX]
    41 0000002E E8 [00000000]                   	CALL	_message_send
    42 00000033 53                              	PUSH	EBX
    43 00000034 68 00002710                     	PUSH	10000
    44 00000039 E8 [00000000]                   	CALL	_message_receive
    45 0000003E                                 L5:
    46 0000003E 83 C4 18                        	ADD	ESP,24
    47 00000041 46                              	INC	ESI
    48 00000042 89 35 00000EF0                  	MOV	DWORD [3824],ESI
    49 00000048 8D 5D D8                        	LEA	EBX,DWORD [-40+EBP]
    50 0000004B E8 [00000000]                   	CALL	_io_hlt
    51 00000050 6A 0F                           	PUSH	15
    52 00000052 68 000000FF                     	PUSH	255
    53 00000057 6A 00                           	PUSH	0
    54 00000059 6A 00                           	PUSH	0
    55 0000005B 6A 00                           	PUSH	0
    56 0000005D 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    57 00000064 50                              	PUSH	EAX
    58 00000065 FF 35 00000FF8                  	PUSH	DWORD [4088]
    59 0000006B E8 [00000000]                   	CALL	_boxfill8
    60 00000070 56                              	PUSH	ESI
    61 00000071 68 [0000000A]                   	PUSH	LC2
    62 00000076 53                              	PUSH	EBX
    63 00000077 E8 [00000000]                   	CALL	_sprintf
    64 0000007C 83 C4 28                        	ADD	ESP,40
    65 0000007F 53                              	PUSH	EBX
    66 00000080 6A 07                           	PUSH	7
    67 00000082 6A 00                           	PUSH	0
    68 00000084 6A 00                           	PUSH	0
    69 00000086 0F BF 05 00000FF4               	MOVSX	EAX,WORD [4084]
    70 0000008D 50                              	PUSH	EAX
    71 0000008E FF 35 00000FF8                  	PUSH	DWORD [4088]
    72 00000094 E8 [00000000]                   	CALL	_putfonts8_asc
    73 00000099 EB A3                           	JMP	L5
    74 0000009B                                 	GLOBAL	_FSEntry
    75 0000009B                                 _FSEntry:
    76 0000009B 55                              	PUSH	EBP
    77 0000009C 89 E5                           	MOV	EBP,ESP
    78 0000009E 56                              	PUSH	ESI
    79 0000009F 53                              	PUSH	EBX
    80 000000A0 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    81 000000A3 E8 [00000000]                   	CALL	_task_alloc
    82 000000A8 68 00010000                     	PUSH	65536
    83 000000AD 89 C3                           	MOV	EBX,EAX
    84 000000AF FF 76 04                        	PUSH	DWORD [4+ESI]
    85 000000B2 E8 [00000000]                   	CALL	_memman_alloc_4k
    86 000000B7 05 00010000                     	ADD	EAX,65536
    87 000000BC 89 43 64                        	MOV	DWORD [100+EBX],EAX
    88 000000BF C7 43 4C [00000000]             	MOV	DWORD [76+EBX],_FS_task
    89 000000C6 C7 43 74 00000008               	MOV	DWORD [116+EBX],8
    90 000000CD C7 43 78 00000010               	MOV	DWORD [120+EBX],16
    91 000000D4 C7 43 7C 00000008               	MOV	DWORD [124+EBX],8
    92 000000DB C7 83 00000080 00000008         	MOV	DWORD [128+EBX],8
    93 000000E5 C7 83 00000084 00000008         	MOV	DWORD [132+EBX],8
    94 000000EF C7 83 00000088 00000008         	MOV	DWORD [136+EBX],8
    95 000000F9 6A 01                           	PUSH	1
    96 000000FB 6A 04                           	PUSH	4
    97 000000FD 53                              	PUSH	EBX
    98 000000FE E8 [00000000]                   	CALL	_task_run
    99 00000103 B8 00000001                     	MOV	EAX,1
   100 00000108 89 5E 08                        	MOV	DWORD [8+ESI],EBX
   101 0000010B 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   102 0000010E 5B                              	POP	EBX
   103 0000010F 5E                              	POP	ESI
   104 00000110 5D                              	POP	EBP
   105 00000111 C3                              	RET
