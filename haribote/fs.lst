     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_GetMyObj
     7 00000000                                 	EXTERN	_message_send
     8 00000000                                 	EXTERN	_message_receive
     9 00000000                                 	EXTERN	_io_hlt
    10 00000000                                 	EXTERN	_task_alloc
    11 00000000                                 	EXTERN	_memman_alloc_4k
    12 00000000                                 	EXTERN	_task_run
    13 00000000                                 [FILE "fs.c"]
    14                                          [SECTION .data]
    15 00000000                                 LC0:
    16 00000000 46 53 00                        	DB	"FS",0x00
    17 00000003                                 LC1:
    18 00000003 49 64 65 20 48 44 00            	DB	"Ide HD",0x00
    19                                          [SECTION .text]
    20 00000000                                 	GLOBAL	_FS_task
    21 00000000                                 _FS_task:
    22 00000000 55                              	PUSH	EBP
    23 00000001 89 E5                           	MOV	EBP,ESP
    24 00000003 56                              	PUSH	ESI
    25 00000004 53                              	PUSH	EBX
    26 00000005 31 DB                           	XOR	EBX,EBX
    27 00000007 68 [00000000]                   	PUSH	LC0
    28 0000000C E8 [00000000]                   	CALL	_GetMyObj
    29 00000011 68 [00000003]                   	PUSH	LC1
    30 00000016 E8 [00000000]                   	CALL	_GetMyObj
    31 0000001B C7 06 00000001                  	MOV	DWORD [ESI],1
    32 00000021 56                              	PUSH	ESI
    33 00000022 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
    34 00000025 FF B0 0000012C                  	PUSH	DWORD [300+EAX]
    35 0000002B E8 [00000000]                   	CALL	_message_send
    36 00000030 56                              	PUSH	ESI
    37 00000031 68 00002710                     	PUSH	10000
    38 00000036 E8 [00000000]                   	CALL	_message_receive
    39 0000003B 83 C4 18                        	ADD	ESP,24
    40 0000003E                                 L2:
    41 0000003E 43                              	INC	EBX
    42 0000003F 89 1D 00000EF0                  	MOV	DWORD [3824],EBX
    43 00000045 E8 [00000000]                   	CALL	_io_hlt
    44 0000004A EB F2                           	JMP	L2
    45 0000004C                                 	GLOBAL	_FSEntry
    46 0000004C                                 _FSEntry:
    47 0000004C 55                              	PUSH	EBP
    48 0000004D 89 E5                           	MOV	EBP,ESP
    49 0000004F 56                              	PUSH	ESI
    50 00000050 53                              	PUSH	EBX
    51 00000051 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    52 00000054 E8 [00000000]                   	CALL	_task_alloc
    53 00000059 68 00010000                     	PUSH	65536
    54 0000005E 89 C3                           	MOV	EBX,EAX
    55 00000060 FF 76 04                        	PUSH	DWORD [4+ESI]
    56 00000063 E8 [00000000]                   	CALL	_memman_alloc_4k
    57 00000068 05 00010000                     	ADD	EAX,65536
    58 0000006D 89 43 64                        	MOV	DWORD [100+EBX],EAX
    59 00000070 C7 43 4C [00000000]             	MOV	DWORD [76+EBX],_FS_task
    60 00000077 C7 43 74 00000008               	MOV	DWORD [116+EBX],8
    61 0000007E C7 43 78 00000010               	MOV	DWORD [120+EBX],16
    62 00000085 C7 43 7C 00000008               	MOV	DWORD [124+EBX],8
    63 0000008C C7 83 00000080 00000008         	MOV	DWORD [128+EBX],8
    64 00000096 C7 83 00000084 00000008         	MOV	DWORD [132+EBX],8
    65 000000A0 C7 83 00000088 00000008         	MOV	DWORD [136+EBX],8
    66 000000AA 6A 01                           	PUSH	1
    67 000000AC 6A 04                           	PUSH	4
    68 000000AE 53                              	PUSH	EBX
    69 000000AF E8 [00000000]                   	CALL	_task_run
    70 000000B4 B8 00000001                     	MOV	EAX,1
    71 000000B9 89 5E 08                        	MOV	DWORD [8+ESI],EBX
    72 000000BC 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    73 000000BF 5B                              	POP	EBX
    74 000000C0 5E                              	POP	ESI
    75 000000C1 5D                              	POP	EBP
    76 000000C2 C3                              	RET
