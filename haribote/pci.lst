     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_out32
     7 00000000                                 	EXTERN	_io_in32
     8 00000000                                 	EXTERN	_io_out8
     9 00000000                                 	EXTERN	_io_out16
    10 00000000                                 	EXTERN	_kalloc
    11 00000000                                 	EXTERN	_list_append
    12 00000000                                 	EXTERN	_list_init
    13 00000000                                 	EXTERN	_sprintf
    14 00000000                                 	EXTERN	_cons_putstr0
    15 00000000                                 	EXTERN	_list_traversal
    16 00000000                                 [FILE "pci.c"]
    17 00000000                                 	GLOBAL	_busnum
    18                                          [SECTION .data]
    19 00000000                                 	ALIGNB	4
    20 00000000                                 _busnum:
    21 00000000 00000000                        	DD	0
    22 00000004                                 	GLOBAL	_devnum
    23 00000004                                 	ALIGNB	4
    24 00000004                                 _devnum:
    25 00000004 00000000                        	DD	0
    26                                          [SECTION .text]
    27 00000000                                 	GLOBAL	__pci_read_byte
    28 00000000                                 __pci_read_byte:
    29 00000000 55                              	PUSH	EBP
    30 00000001 89 E5                           	MOV	EBP,ESP
    31 00000003 53                              	PUSH	EBX
    32 00000004 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    33 00000007 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    34 0000000A C1 E0 0B                        	SAL	EAX,11
    35 0000000D 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
    36 00000010 C1 E2 10                        	SAL	EDX,16
    37 00000013 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    38 00000016 C1 E1 08                        	SAL	ECX,8
    39 00000019 09 C2                           	OR	EDX,EAX
    40 0000001B 89 D8                           	MOV	EAX,EBX
    41 0000001D 09 CA                           	OR	EDX,ECX
    42 0000001F 25 000000FC                     	AND	EAX,252
    43 00000024 83 E3 03                        	AND	EBX,3
    44 00000027 09 C2                           	OR	EDX,EAX
    45 00000029 81 CA 80000000                  	OR	EDX,-2147483648
    46 0000002F 52                              	PUSH	EDX
    47 00000030 68 00000CF8                     	PUSH	3320
    48 00000035 E8 [00000000]                   	CALL	_io_out32
    49 0000003A 68 00000CFC                     	PUSH	3324
    50 0000003F E8 [00000000]                   	CALL	_io_in32
    51 00000044 8D 0C DD 00000000               	LEA	ECX,DWORD [0+EBX*8]
    52 0000004B D3 F8                           	SAR	EAX,CL
    53 0000004D 25 000000FF                     	AND	EAX,255
    54 00000052 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
    55 00000055 C9                              	LEAVE
    56 00000056 C3                              	RET
    57 00000057                                 	GLOBAL	__pci_read_word
    58 00000057                                 __pci_read_word:
    59 00000057 55                              	PUSH	EBP
    60 00000058 89 E5                           	MOV	EBP,ESP
    61 0000005A 53                              	PUSH	EBX
    62 0000005B 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    63 0000005E 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    64 00000061 C1 E0 0B                        	SAL	EAX,11
    65 00000064 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
    66 00000067 C1 E2 10                        	SAL	EDX,16
    67 0000006A 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    68 0000006D C1 E1 08                        	SAL	ECX,8
    69 00000070 09 C2                           	OR	EDX,EAX
    70 00000072 89 D8                           	MOV	EAX,EBX
    71 00000074 09 CA                           	OR	EDX,ECX
    72 00000076 25 000000FC                     	AND	EAX,252
    73 0000007B 83 E3 02                        	AND	EBX,2
    74 0000007E 09 C2                           	OR	EDX,EAX
    75 00000080 81 CA 80000000                  	OR	EDX,-2147483648
    76 00000086 52                              	PUSH	EDX
    77 00000087 68 00000CF8                     	PUSH	3320
    78 0000008C E8 [00000000]                   	CALL	_io_out32
    79 00000091 68 00000CFC                     	PUSH	3324
    80 00000096 E8 [00000000]                   	CALL	_io_in32
    81 0000009B 8D 0C DD 00000000               	LEA	ECX,DWORD [0+EBX*8]
    82 000000A2 D3 F8                           	SAR	EAX,CL
    83 000000A4 25 0000FFFF                     	AND	EAX,65535
    84 000000A9 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
    85 000000AC C9                              	LEAVE
    86 000000AD C3                              	RET
    87 000000AE                                 	GLOBAL	__pci_read_dword
    88 000000AE                                 __pci_read_dword:
    89 000000AE 55                              	PUSH	EBP
    90 000000AF 89 E5                           	MOV	EBP,ESP
    91 000000B1 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    92 000000B4 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    93 000000B7 C1 E0 0B                        	SAL	EAX,11
    94 000000BA 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    95 000000BD C1 E2 10                        	SAL	EDX,16
    96 000000C0 C1 E1 08                        	SAL	ECX,8
    97 000000C3 09 C2                           	OR	EDX,EAX
    98 000000C5 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    99 000000C8 09 CA                           	OR	EDX,ECX
   100 000000CA 25 000000FC                     	AND	EAX,252
   101 000000CF 09 C2                           	OR	EDX,EAX
   102 000000D1 81 CA 80000000                  	OR	EDX,-2147483648
   103 000000D7 52                              	PUSH	EDX
   104 000000D8 68 00000CF8                     	PUSH	3320
   105 000000DD E8 [00000000]                   	CALL	_io_out32
   106 000000E2 58                              	POP	EAX
   107 000000E3 5A                              	POP	EDX
   108 000000E4 C7 45 08 00000CFC               	MOV	DWORD [8+EBP],3324
   109 000000EB C9                              	LEAVE
   110 000000EC E9 [00000000]                   	JMP	_io_in32
   111 000000F1                                 	GLOBAL	__pci_write_byte
   112 000000F1                                 __pci_write_byte:
   113 000000F1 55                              	PUSH	EBP
   114 000000F2 89 E5                           	MOV	EBP,ESP
   115 000000F4 53                              	PUSH	EBX
   116 000000F5 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   117 000000F8 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   118 000000FB C1 E0 0B                        	SAL	EAX,11
   119 000000FE 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   120 00000101 C1 E2 10                        	SAL	EDX,16
   121 00000104 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   122 00000107 C1 E1 08                        	SAL	ECX,8
   123 0000010A 09 C2                           	OR	EDX,EAX
   124 0000010C 89 D8                           	MOV	EAX,EBX
   125 0000010E 09 CA                           	OR	EDX,ECX
   126 00000110 25 000000FC                     	AND	EAX,252
   127 00000115 83 E3 03                        	AND	EBX,3
   128 00000118 09 C2                           	OR	EDX,EAX
   129 0000011A 81 C3 00000CFC                  	ADD	EBX,3324
   130 00000120 81 CA 80000000                  	OR	EDX,-2147483648
   131 00000126 52                              	PUSH	EDX
   132 00000127 68 00000CF8                     	PUSH	3320
   133 0000012C E8 [00000000]                   	CALL	_io_out32
   134 00000131 53                              	PUSH	EBX
   135 00000132 0F BE 45 18                     	MOVSX	EAX,BYTE [24+EBP]
   136 00000136 50                              	PUSH	EAX
   137 00000137 E8 [00000000]                   	CALL	_io_out8
   138 0000013C 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   139 0000013F 31 C0                           	XOR	EAX,EAX
   140 00000141 C9                              	LEAVE
   141 00000142 C3                              	RET
   142 00000143                                 	GLOBAL	__pci_write_word
   143 00000143                                 __pci_write_word:
   144 00000143 55                              	PUSH	EBP
   145 00000144 89 E5                           	MOV	EBP,ESP
   146 00000146 53                              	PUSH	EBX
   147 00000147 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   148 0000014A 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   149 0000014D C1 E0 0B                        	SAL	EAX,11
   150 00000150 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   151 00000153 C1 E2 10                        	SAL	EDX,16
   152 00000156 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   153 00000159 C1 E1 08                        	SAL	ECX,8
   154 0000015C 09 C2                           	OR	EDX,EAX
   155 0000015E 89 D8                           	MOV	EAX,EBX
   156 00000160 09 CA                           	OR	EDX,ECX
   157 00000162 25 000000FC                     	AND	EAX,252
   158 00000167 83 E3 02                        	AND	EBX,2
   159 0000016A 09 C2                           	OR	EDX,EAX
   160 0000016C 81 C3 00000CFC                  	ADD	EBX,3324
   161 00000172 81 CA 80000000                  	OR	EDX,-2147483648
   162 00000178 52                              	PUSH	EDX
   163 00000179 68 00000CF8                     	PUSH	3320
   164 0000017E E8 [00000000]                   	CALL	_io_out32
   165 00000183 53                              	PUSH	EBX
   166 00000184 0F BF 45 18                     	MOVSX	EAX,WORD [24+EBP]
   167 00000188 50                              	PUSH	EAX
   168 00000189 E8 [00000000]                   	CALL	_io_out16
   169 0000018E 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   170 00000191 31 C0                           	XOR	EAX,EAX
   171 00000193 C9                              	LEAVE
   172 00000194 C3                              	RET
   173 00000195                                 	GLOBAL	__pci_write_dword
   174 00000195                                 __pci_write_dword:
   175 00000195 55                              	PUSH	EBP
   176 00000196 89 E5                           	MOV	EBP,ESP
   177 00000198 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   178 0000019B 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   179 0000019E C1 E0 0B                        	SAL	EAX,11
   180 000001A1 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   181 000001A4 C1 E2 10                        	SAL	EDX,16
   182 000001A7 C1 E1 08                        	SAL	ECX,8
   183 000001AA 09 C2                           	OR	EDX,EAX
   184 000001AC 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   185 000001AF 09 CA                           	OR	EDX,ECX
   186 000001B1 25 000000FC                     	AND	EAX,252
   187 000001B6 09 C2                           	OR	EDX,EAX
   188 000001B8 81 CA 80000000                  	OR	EDX,-2147483648
   189 000001BE 52                              	PUSH	EDX
   190 000001BF 68 00000CF8                     	PUSH	3320
   191 000001C4 E8 [00000000]                   	CALL	_io_out32
   192 000001C9 68 00000CFC                     	PUSH	3324
   193 000001CE FF 75 18                        	PUSH	DWORD [24+EBP]
   194 000001D1 E8 [00000000]                   	CALL	_io_out32
   195 000001D6 31 C0                           	XOR	EAX,EAX
   196 000001D8 C9                              	LEAVE
   197 000001D9 C3                              	RET
   198 000001DA                                 	GLOBAL	_pci_read_byte
   199 000001DA                                 _pci_read_byte:
   200 000001DA 55                              	PUSH	EBP
   201 000001DB 89 E5                           	MOV	EBP,ESP
   202 000001DD 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   203 000001E0 FF 75 0C                        	PUSH	DWORD [12+EBP]
   204 000001E3 FF 70 10                        	PUSH	DWORD [16+EAX]
   205 000001E6 FF 70 0C                        	PUSH	DWORD [12+EAX]
   206 000001E9 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   207 000001EC FF 30                           	PUSH	DWORD [EAX]
   208 000001EE E8 FFFFFE0D                     	CALL	__pci_read_byte
   209 000001F3 C9                              	LEAVE
   210 000001F4 C3                              	RET
   211 000001F5                                 	GLOBAL	_pci_read_word
   212 000001F5                                 _pci_read_word:
   213 000001F5 55                              	PUSH	EBP
   214 000001F6 89 E5                           	MOV	EBP,ESP
   215 000001F8 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   216 000001FB FF 75 0C                        	PUSH	DWORD [12+EBP]
   217 000001FE FF 70 10                        	PUSH	DWORD [16+EAX]
   218 00000201 FF 70 0C                        	PUSH	DWORD [12+EAX]
   219 00000204 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   220 00000207 FF 30                           	PUSH	DWORD [EAX]
   221 00000209 E8 FFFFFE49                     	CALL	__pci_read_word
   222 0000020E C9                              	LEAVE
   223 0000020F C3                              	RET
   224 00000210                                 	GLOBAL	_pci_read_dword
   225 00000210                                 _pci_read_dword:
   226 00000210 55                              	PUSH	EBP
   227 00000211 89 E5                           	MOV	EBP,ESP
   228 00000213 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   229 00000216 FF 75 0C                        	PUSH	DWORD [12+EBP]
   230 00000219 FF 70 10                        	PUSH	DWORD [16+EAX]
   231 0000021C FF 70 0C                        	PUSH	DWORD [12+EAX]
   232 0000021F 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   233 00000222 FF 30                           	PUSH	DWORD [EAX]
   234 00000224 E8 FFFFFE85                     	CALL	__pci_read_dword
   235 00000229 C9                              	LEAVE
   236 0000022A C3                              	RET
   237 0000022B                                 	GLOBAL	_pci_write_byte
   238 0000022B                                 _pci_write_byte:
   239 0000022B 55                              	PUSH	EBP
   240 0000022C 89 E5                           	MOV	EBP,ESP
   241 0000022E FF 75 10                        	PUSH	DWORD [16+EBP]
   242 00000231 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   243 00000234 FF 75 0C                        	PUSH	DWORD [12+EBP]
   244 00000237 FF 70 10                        	PUSH	DWORD [16+EAX]
   245 0000023A FF 70 0C                        	PUSH	DWORD [12+EAX]
   246 0000023D 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   247 00000240 FF 30                           	PUSH	DWORD [EAX]
   248 00000242 E8 FFFFFEAA                     	CALL	__pci_write_byte
   249 00000247 31 C0                           	XOR	EAX,EAX
   250 00000249 C9                              	LEAVE
   251 0000024A C3                              	RET
   252 0000024B                                 	GLOBAL	_pci_write_word
   253 0000024B                                 _pci_write_word:
   254 0000024B 55                              	PUSH	EBP
   255 0000024C 89 E5                           	MOV	EBP,ESP
   256 0000024E FF 75 10                        	PUSH	DWORD [16+EBP]
   257 00000251 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   258 00000254 FF 75 0C                        	PUSH	DWORD [12+EBP]
   259 00000257 FF 70 10                        	PUSH	DWORD [16+EAX]
   260 0000025A FF 70 0C                        	PUSH	DWORD [12+EAX]
   261 0000025D 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   262 00000260 FF 30                           	PUSH	DWORD [EAX]
   263 00000262 E8 FFFFFEDC                     	CALL	__pci_write_word
   264 00000267 31 C0                           	XOR	EAX,EAX
   265 00000269 C9                              	LEAVE
   266 0000026A C3                              	RET
   267 0000026B                                 	GLOBAL	_pci_write_dword
   268 0000026B                                 _pci_write_dword:
   269 0000026B 55                              	PUSH	EBP
   270 0000026C 89 E5                           	MOV	EBP,ESP
   271 0000026E FF 75 10                        	PUSH	DWORD [16+EBP]
   272 00000271 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   273 00000274 FF 75 0C                        	PUSH	DWORD [12+EBP]
   274 00000277 FF 70 10                        	PUSH	DWORD [16+EAX]
   275 0000027A FF 70 0C                        	PUSH	DWORD [12+EAX]
   276 0000027D 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   277 00000280 FF 30                           	PUSH	DWORD [EAX]
   278 00000282 E8 FFFFFF0E                     	CALL	__pci_write_dword
   279 00000287 31 C0                           	XOR	EAX,EAX
   280 00000289 C9                              	LEAVE
   281 0000028A C3                              	RET
   282 0000028B                                 	GLOBAL	_pci_config_dev
   283 0000028B                                 _pci_config_dev:
   284 0000028B 55                              	PUSH	EBP
   285 0000028C 89 E5                           	MOV	EBP,ESP
   286 0000028E 5D                              	POP	EBP
   287 0000028F C3                              	RET
   288 00000290                                 	GLOBAL	_pci_add_dev
   289 00000290                                 _pci_add_dev:
   290 00000290 55                              	PUSH	EBP
   291 00000291 89 E5                           	MOV	EBP,ESP
   292 00000293 56                              	PUSH	ESI
   293 00000294 53                              	PUSH	EBX
   294 00000295 6A 7C                           	PUSH	124
   295 00000297 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   296 0000029A E8 [00000000]                   	CALL	_kalloc
   297 0000029F 89 C3                           	MOV	EBX,EAX
   298 000002A1 8B 46 08                        	MOV	EAX,DWORD [8+ESI]
   299 000002A4 89 43 08                        	MOV	DWORD [8+EBX],EAX
   300 000002A7 8B 46 0C                        	MOV	EAX,DWORD [12+ESI]
   301 000002AA 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   302 000002AD 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   303 000002B0 89 43 10                        	MOV	DWORD [16+EBX],EAX
   304 000002B3 8A 46 18                        	MOV	AL,BYTE [24+ESI]
   305 000002B6 88 43 18                        	MOV	BYTE [24+EBX],AL
   306 000002B9 6A 00                           	PUSH	0
   307 000002BB FF 73 10                        	PUSH	DWORD [16+EBX]
   308 000002BE FF 73 0C                        	PUSH	DWORD [12+EBX]
   309 000002C1 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   310 000002C4 FF 30                           	PUSH	DWORD [EAX]
   311 000002C6 E8 FFFFFD8C                     	CALL	__pci_read_word
   312 000002CB 66 89 43 14                     	MOV	WORD [20+EBX],AX
   313 000002CF 6A 02                           	PUSH	2
   314 000002D1 FF 73 10                        	PUSH	DWORD [16+EBX]
   315 000002D4 FF 73 0C                        	PUSH	DWORD [12+EBX]
   316 000002D7 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   317 000002DA FF 30                           	PUSH	DWORD [EAX]
   318 000002DC E8 FFFFFD76                     	CALL	__pci_read_word
   319 000002E1 83 C4 24                        	ADD	ESP,36
   320 000002E4 66 89 43 16                     	MOV	WORD [22+EBX],AX
   321 000002E8 6A 08                           	PUSH	8
   322 000002EA FF 73 10                        	PUSH	DWORD [16+EBX]
   323 000002ED FF 73 0C                        	PUSH	DWORD [12+EBX]
   324 000002F0 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   325 000002F3 FF 30                           	PUSH	DWORD [EAX]
   326 000002F5 E8 FFFFFDB4                     	CALL	__pci_read_dword
   327 000002FA 89 43 1C                        	MOV	DWORD [28+EBX],EAX
   328 000002FD 53                              	PUSH	EBX
   329 000002FE E8 FFFFFF88                     	CALL	_pci_config_dev
   330 00000303 53                              	PUSH	EBX
   331 00000304 68 [00000020]                   	PUSH	_pci_dev_list
   332 00000309 E8 [00000000]                   	CALL	_list_append
   333 0000030E 89 D8                           	MOV	EAX,EBX
   334 00000310 FF 05 [00000004]                	INC	DWORD [_devnum]
   335 00000316 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   336 00000319 5B                              	POP	EBX
   337 0000031A 5E                              	POP	ESI
   338 0000031B 5D                              	POP	EBP
   339 0000031C C3                              	RET
   340 0000031D                                 	GLOBAL	_pci_check_func
   341 0000031D                                 _pci_check_func:
   342 0000031D 55                              	PUSH	EBP
   343 0000031E 89 E5                           	MOV	EBP,ESP
   344 00000320 57                              	PUSH	EDI
   345 00000321 56                              	PUSH	ESI
   346 00000322 53                              	PUSH	EBX
   347 00000323 83 C4 80                        	ADD	ESP,-128
   348 00000326 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
   349 00000329 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   350 0000032C 6A 0E                           	PUSH	14
   351 0000032E 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   352 00000331 53                              	PUSH	EBX
   353 00000332 8B 04 BD [00000040]             	MOV	EAX,DWORD [_bus_list+EDI*4]
   354 00000339 56                              	PUSH	ESI
   355 0000033A 89 85 FFFFFF7C                  	MOV	DWORD [-132+EBP],EAX
   356 00000340 57                              	PUSH	EDI
   357 00000341 89 75 80                        	MOV	DWORD [-128+EBP],ESI
   358 00000344 89 5D 84                        	MOV	DWORD [-124+EBP],EBX
   359 00000347 E8 FFFFFCB4                     	CALL	__pci_read_byte
   360 0000034C 88 45 8C                        	MOV	BYTE [-116+EBP],AL
   361 0000034F 8D 85 FFFFFF74                  	LEA	EAX,DWORD [-140+EBP]
   362 00000355 50                              	PUSH	EAX
   363 00000356 E8 FFFFFF35                     	CALL	_pci_add_dev
   364 0000035B 6A 0A                           	PUSH	10
   365 0000035D 53                              	PUSH	EBX
   366 0000035E 56                              	PUSH	ESI
   367 0000035F 57                              	PUSH	EDI
   368 00000360 E8 FFFFFCF2                     	CALL	__pci_read_word
   369 00000365 83 C4 24                        	ADD	ESP,36
   370 00000368 3D 00000604                     	CMP	EAX,1540
   371 0000036D 74 08                           	JE	L17
   372 0000036F                                 L15:
   373 0000036F 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   374 00000372 5B                              	POP	EBX
   375 00000373 5E                              	POP	ESI
   376 00000374 5F                              	POP	EDI
   377 00000375 5D                              	POP	EBP
   378 00000376 C3                              	RET
   379 00000377                                 L17:
   380 00000377 6A 19                           	PUSH	25
   381 00000379 53                              	PUSH	EBX
   382 0000037A 56                              	PUSH	ESI
   383 0000037B 57                              	PUSH	EDI
   384 0000037C E8 FFFFFC7F                     	CALL	__pci_read_byte
   385 00000381 83 C4 10                        	ADD	ESP,16
   386 00000384 50                              	PUSH	EAX
   387 00000385 E8 0000009B                     	CALL	_pci_scan_bus
   388 0000038A 59                              	POP	ECX
   389 0000038B EB E2                           	JMP	L15
   390 0000038D                                 	GLOBAL	_pci_check_dev
   391 0000038D                                 _pci_check_dev:
   392 0000038D 55                              	PUSH	EBP
   393 0000038E 89 E5                           	MOV	EBP,ESP
   394 00000390 57                              	PUSH	EDI
   395 00000391 56                              	PUSH	ESI
   396 00000392 53                              	PUSH	EBX
   397 00000393 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   398 00000396 6A 00                           	PUSH	0
   399 00000398 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   400 0000039B 6A 00                           	PUSH	0
   401 0000039D 56                              	PUSH	ESI
   402 0000039E 57                              	PUSH	EDI
   403 0000039F E8 FFFFFCB3                     	CALL	__pci_read_word
   404 000003A4 83 C4 10                        	ADD	ESP,16
   405 000003A7 3D 0000FFFF                     	CMP	EAX,65535
   406 000003AC 74 12                           	JE	L18
   407 000003AE 6A 00                           	PUSH	0
   408 000003B0 6A 00                           	PUSH	0
   409 000003B2 56                              	PUSH	ESI
   410 000003B3 57                              	PUSH	EDI
   411 000003B4 E8 FFFFFC9E                     	CALL	__pci_read_word
   412 000003B9 83 C4 10                        	ADD	ESP,16
   413 000003BC 85 C0                           	TEST	EAX,EAX
   414 000003BE 75 08                           	JNE	L30
   415 000003C0                                 L18:
   416 000003C0 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   417 000003C3 5B                              	POP	EBX
   418 000003C4 5E                              	POP	ESI
   419 000003C5 5F                              	POP	EDI
   420 000003C6 5D                              	POP	EBP
   421 000003C7 C3                              	RET
   422 000003C8                                 L30:
   423 000003C8 6A 0E                           	PUSH	14
   424 000003CA 6A 00                           	PUSH	0
   425 000003CC 56                              	PUSH	ESI
   426 000003CD 57                              	PUSH	EDI
   427 000003CE E8 FFFFFC2D                     	CALL	__pci_read_byte
   428 000003D3 83 C4 10                        	ADD	ESP,16
   429 000003D6 83 E0 01                        	AND	EAX,1
   430 000003D9 74 3C                           	JE	L21
   431 000003DB 31 DB                           	XOR	EBX,EBX
   432 000003DD                                 L27:
   433 000003DD 6A 00                           	PUSH	0
   434 000003DF 53                              	PUSH	EBX
   435 000003E0 56                              	PUSH	ESI
   436 000003E1 57                              	PUSH	EDI
   437 000003E2 E8 FFFFFC70                     	CALL	__pci_read_word
   438 000003E7 83 C4 10                        	ADD	ESP,16
   439 000003EA 3D 0000FFFF                     	CMP	EAX,65535
   440 000003EF 74 11                           	JE	L24
   441 000003F1 6A 00                           	PUSH	0
   442 000003F3 53                              	PUSH	EBX
   443 000003F4 56                              	PUSH	ESI
   444 000003F5 57                              	PUSH	EDI
   445 000003F6 E8 FFFFFC5C                     	CALL	__pci_read_word
   446 000003FB 83 C4 10                        	ADD	ESP,16
   447 000003FE 85 C0                           	TEST	EAX,EAX
   448 00000400 75 08                           	JNE	L31
   449 00000402                                 L24:
   450 00000402 43                              	INC	EBX
   451 00000403 83 FB 07                        	CMP	EBX,7
   452 00000406 7E D5                           	JLE	L27
   453 00000408 EB B6                           	JMP	L18
   454 0000040A                                 L31:
   455 0000040A 53                              	PUSH	EBX
   456 0000040B 56                              	PUSH	ESI
   457 0000040C 57                              	PUSH	EDI
   458 0000040D E8 FFFFFF0B                     	CALL	_pci_check_func
   459 00000412 83 C4 0C                        	ADD	ESP,12
   460 00000415 EB EB                           	JMP	L24
   461 00000417                                 L21:
   462 00000417 6A 00                           	PUSH	0
   463 00000419 56                              	PUSH	ESI
   464 0000041A 57                              	PUSH	EDI
   465 0000041B E8 FFFFFEFD                     	CALL	_pci_check_func
   466 00000420 83 C4 0C                        	ADD	ESP,12
   467 00000423 EB 9B                           	JMP	L18
   468 00000425                                 	GLOBAL	_pci_scan_bus
   469 00000425                                 _pci_scan_bus:
   470 00000425 55                              	PUSH	EBP
   471 00000426 89 E5                           	MOV	EBP,ESP
   472 00000428 56                              	PUSH	ESI
   473 00000429 53                              	PUSH	EBX
   474 0000042A 31 DB                           	XOR	EBX,EBX
   475 0000042C 83 EC 30                        	SUB	ESP,48
   476 0000042F 8D 45 C8                        	LEA	EAX,DWORD [-56+EBP]
   477 00000432 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   478 00000435 89 75 C8                        	MOV	DWORD [-56+EBP],ESI
   479 00000438 89 75 D0                        	MOV	DWORD [-48+EBP],ESI
   480 0000043B 89 75 CC                        	MOV	DWORD [-52+EBP],ESI
   481 0000043E 89 04 B5 [00000040]             	MOV	DWORD [_bus_list+ESI*4],EAX
   482 00000445                                 L37:
   483 00000445 53                              	PUSH	EBX
   484 00000446 43                              	INC	EBX
   485 00000447 56                              	PUSH	ESI
   486 00000448 E8 FFFFFF40                     	CALL	_pci_check_dev
   487 0000044D 83 FB 1F                        	CMP	EBX,31
   488 00000450 58                              	POP	EAX
   489 00000451 5A                              	POP	EDX
   490 00000452 7E F1                           	JLE	L37
   491 00000454 FF 05 [00000000]                	INC	DWORD [_busnum]
   492 0000045A 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   493 0000045D 5B                              	POP	EBX
   494 0000045E 5E                              	POP	ESI
   495 0000045F 5D                              	POP	EBP
   496 00000460 C3                              	RET
   497 00000461                                 	GLOBAL	_pci_probe
   498 00000461                                 _pci_probe:
   499 00000461 55                              	PUSH	EBP
   500 00000462 89 E5                           	MOV	EBP,ESP
   501 00000464 6A 00                           	PUSH	0
   502 00000466 6A 00                           	PUSH	0
   503 00000468 6A 00                           	PUSH	0
   504 0000046A 6A 00                           	PUSH	0
   505 0000046C E8 FFFFFC3D                     	CALL	__pci_read_dword
   506 00000471 83 C4 10                        	ADD	ESP,16
   507 00000474 40                              	INC	EAX
   508 00000475 0F 95 C0                        	SETNE	AL
   509 00000478 0F B6 C0                        	MOVZX	EAX,AL
   510 0000047B C9                              	LEAVE
   511 0000047C C3                              	RET
   512 0000047D                                 	GLOBAL	_pci_init
   513 0000047D                                 _pci_init:
   514 0000047D 55                              	PUSH	EBP
   515 0000047E 89 E5                           	MOV	EBP,ESP
   516 00000480 E8 FFFFFFDC                     	CALL	_pci_probe
   517 00000485 31 D2                           	XOR	EDX,EDX
   518 00000487 85 C0                           	TEST	EAX,EAX
   519 00000489 75 04                           	JNE	L44
   520 0000048B                                 L42:
   521 0000048B 89 D0                           	MOV	EAX,EDX
   522 0000048D C9                              	LEAVE
   523 0000048E C3                              	RET
   524 0000048F                                 L44:
   525 0000048F 68 [00000030]                   	PUSH	_pci_bus_list
   526 00000494 E8 [00000000]                   	CALL	_list_init
   527 00000499 68 [00000020]                   	PUSH	_pci_dev_list
   528 0000049E E8 [00000000]                   	CALL	_list_init
   529 000004A3 6A 00                           	PUSH	0
   530 000004A5 E8 FFFFFF7B                     	CALL	_pci_scan_bus
   531 000004AA BA 00000001                     	MOV	EDX,1
   532 000004AF EB DA                           	JMP	L42
   533                                          [SECTION .data]
   534 00000008                                 LC0:
   535 00000008 25 34 78 20 25 34 78 20 25 64   	DB	"%4x %4x %d %d %d",0x0A,0x00
       00000012 20 25 64 20 25 64 0A 00 
   536                                          [SECTION .text]
   537 000004B1                                 	GLOBAL	_pci_test_f
   538 000004B1                                 _pci_test_f:
   539 000004B1 55                              	PUSH	EBP
   540 000004B2 89 E5                           	MOV	EBP,ESP
   541 000004B4 53                              	PUSH	EBX
   542 000004B5 81 EC 000003F0                  	SUB	ESP,1008
   543 000004BB 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   544 000004BE 8D 9D FFFFFC0C                  	LEA	EBX,DWORD [-1012+EBP]
   545 000004C4 FF 72 10                        	PUSH	DWORD [16+EDX]
   546 000004C7 FF 72 0C                        	PUSH	DWORD [12+EDX]
   547 000004CA 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   548 000004CD FF 30                           	PUSH	DWORD [EAX]
   549 000004CF 0F BF 42 16                     	MOVSX	EAX,WORD [22+EDX]
   550 000004D3 50                              	PUSH	EAX
   551 000004D4 0F BF 42 14                     	MOVSX	EAX,WORD [20+EDX]
   552 000004D8 50                              	PUSH	EAX
   553 000004D9 68 [00000008]                   	PUSH	LC0
   554 000004DE 53                              	PUSH	EBX
   555 000004DF E8 [00000000]                   	CALL	_sprintf
   556 000004E4 53                              	PUSH	EBX
   557 000004E5 FF 75 0C                        	PUSH	DWORD [12+EBP]
   558 000004E8 E8 [00000000]                   	CALL	_cons_putstr0
   559 000004ED 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   560 000004F0 31 C0                           	XOR	EAX,EAX
   561 000004F2 C9                              	LEAVE
   562 000004F3 C3                              	RET
   563                                          [SECTION .data]
   564 0000001A                                 LC1:
   565 0000001A 25 64 0A 0A 00                  	DB	"%d",0x0A,0x0A,0x00
   566                                          [SECTION .text]
   567 000004F4                                 	GLOBAL	_pci_test
   568 000004F4                                 _pci_test:
   569 000004F4 55                              	PUSH	EBP
   570 000004F5 89 E5                           	MOV	EBP,ESP
   571 000004F7 56                              	PUSH	ESI
   572 000004F8 53                              	PUSH	EBX
   573 000004F9 83 EC 70                        	SUB	ESP,112
   574 000004FC 8D 5D 88                        	LEA	EBX,DWORD [-120+EBP]
   575 000004FF 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   576 00000502 56                              	PUSH	ESI
   577 00000503 68 [000004B1]                   	PUSH	_pci_test_f
   578 00000508 68 [00000020]                   	PUSH	_pci_dev_list
   579 0000050D E8 [00000000]                   	CALL	_list_traversal
   580 00000512 FF 35 [00000000]                	PUSH	DWORD [_busnum]
   581 00000518 68 [0000001A]                   	PUSH	LC1
   582 0000051D 53                              	PUSH	EBX
   583 0000051E E8 [00000000]                   	CALL	_sprintf
   584 00000523 53                              	PUSH	EBX
   585 00000524 56                              	PUSH	ESI
   586 00000525 E8 [00000000]                   	CALL	_cons_putstr0
   587 0000052A 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   588 0000052D 5B                              	POP	EBX
   589 0000052E 5E                              	POP	ESI
   590 0000052F 5D                              	POP	EBP
   591 00000530 C3                              	RET
   592 00000531                                 	GLOBAL	_PCIEntry
   593 00000531                                 _PCIEntry:
   594 00000531 55                              	PUSH	EBP
   595 00000532 89 E5                           	MOV	EBP,ESP
   596 00000534 5D                              	POP	EBP
   597 00000535 E9 FFFFFF43                     	JMP	_pci_init
   598 0000053A                                 	GLOBAL	_pci_dev_list
   599                                          [SECTION .data]
   600 0000001F 00                              	ALIGNB	16
   601 00000020                                 _pci_dev_list:
   602 00000020 00 00 00 00 00 00 00 00 00 00   	RESB	16
       0000002A 00 00 00 00 00 00 
   603 00000030                                 	GLOBAL	_pci_bus_list
   604                                          [SECTION .data]
   605 00000030                                 	ALIGNB	16
   606 00000030                                 _pci_bus_list:
   607 00000030 00 00 00 00 00 00 00 00 00 00   	RESB	16
       0000003A 00 00 00 00 00 00 
   608 00000040                                 	GLOBAL	_bus_list
   609                                          [SECTION .data]
   610 00000040                                 	ALIGNB	16
   611 00000040                                 _bus_list:
   612 00000040 00 00 00 00 00 00 00 00 00 00   	RESB	1024
       0000004A 00 00 00 00 00 00 00 00 00 00 
       00000054 00 00 00 00 00 00 00 00 00 00 
       0000005E 00 00 00 00 00 00 00 00 00 00 
       00000068 00 00 00 00 00 00 00 00 00 00 
       00000072 00 00 00 00 00 00 00 00 00 00 
       0000007C 00 00 00 00 00 00 00 00 00 00 
       00000086 00 00 00 00 00 00 00 00 00 00 
       00000090 00 00 00 00 00 00 00 00 00 00 
       0000009A 00 00 00 00 00 00 00 00 00 00 
       000000A4 00 00 00 00 00 00 00 00 00 00 
       000000AE 00 00 00 00 00 00 00 00 00 00 
       000000B8 00 00 00 00 00 00 00 00 00 00 
       000000C2 00 00 00 00 00 00 00 00 00 00 
       000000CC 00 00 00 00 00 00 00 00 00 00 
       000000D6 00 00 00 00 00 00 00 00 00 00 
       000000E0 00 00 00 00 00 00 00 00 00 00 
       000000EA 00 00 00 00 00 00 00 00 00 00 
       000000F4 00 00 00 00 00 00 00 00 00 00 
       000000FE 00 00 00 00 00 00 00 00 00 00 
       00000108 00 00 00 00 00 00 00 00 00 00 
       00000112 00 00 00 00 00 00 00 00 00 00 
       0000011C 00 00 00 00 00 00 00 00 00 00 
       00000126 00 00 00 00 00 00 00 00 00 00 
       00000130 00 00 00 00 00 00 00 00 00 00 
       0000013A 00 00 00 00 00 00 00 00 00 00 
       00000144 00 00 00 00 00 00 00 00 00 00 
       0000014E 00 00 00 00 00 00 00 00 00 00 
       00000158 00 00 00 00 00 00 00 00 00 00 
       00000162 00 00 00 00 00 00 00 00 00 00 
       0000016C 00 00 00 00 00 00 00 00 00 00 
       00000176 00 00 00 00 00 00 00 00 00 00 
       00000180 00 00 00 00 00 00 00 00 00 00 
       0000018A 00 00 00 00 00 00 00 00 00 00 
       00000194 00 00 00 00 00 00 00 00 00 00 
       0000019E 00 00 00 00 00 00 00 00 00 00 
       000001A8 00 00 00 00 00 00 00 00 00 00 
       000001B2 00 00 00 00 00 00 00 00 00 00 
       000001BC 00 00 00 00 00 00 00 00 00 00 
       000001C6 00 00 00 00 00 00 00 00 00 00 
       000001D0 00 00 00 00 00 00 00 00 00 00 
       000001DA 00 00 00 00 00 00 00 00 00 00 
       000001E4 00 00 00 00 00 00 00 00 00 00 
       000001EE 00 00 00 00 00 00 00 00 00 00 
       000001F8 00 00 00 00 00 00 00 00 00 00 
       00000202 00 00 00 00 00 00 00 00 00 00 
       0000020C 00 00 00 00 00 00 00 00 00 00 
       00000216 00 00 00 00 00 00 00 00 00 00 
       00000220 00 00 00 00 00 00 00 00 00 00 
       0000022A 00 00 00 00 00 00 00 00 00 00 
       00000234 00 00 00 00 00 00 00 00 00 00 
       0000023E 00 00 00 00 00 00 00 00 00 00 
       00000248 00 00 00 00 00 00 00 00 00 00 
       00000252 00 00 00 00 00 00 00 00 00 00 
       0000025C 00 00 00 00 00 00 00 00 00 00 
       00000266 00 00 00 00 00 00 00 00 00 00 
       00000270 00 00 00 00 00 00 00 00 00 00 
       0000027A 00 00 00 00 00 00 00 00 00 00 
       00000284 00 00 00 00 00 00 00 00 00 00 
       0000028E 00 00 00 00 00 00 00 00 00 00 
       00000298 00 00 00 00 00 00 00 00 00 00 
       000002A2 00 00 00 00 00 00 00 00 00 00 
       000002AC 00 00 00 00 00 00 00 00 00 00 
       000002B6 00 00 00 00 00 00 00 00 00 00 
       000002C0 00 00 00 00 00 00 00 00 00 00 
       000002CA 00 00 00 00 00 00 00 00 00 00 
       000002D4 00 00 00 00 00 00 00 00 00 00 
       000002DE 00 00 00 00 00 00 00 00 00 00 
       000002E8 00 00 00 00 00 00 00 00 00 00 
       000002F2 00 00 00 00 00 00 00 00 00 00 
       000002FC 00 00 00 00 00 00 00 00 00 00 
       00000306 00 00 00 00 00 00 00 00 00 00 
       00000310 00 00 00 00 00 00 00 00 00 00 
       0000031A 00 00 00 00 00 00 00 00 00 00 
       00000324 00 00 00 00 00 00 00 00 00 00 
       0000032E 00 00 00 00 00 00 00 00 00 00 
       00000338 00 00 00 00 00 00 00 00 00 00 
       00000342 00 00 00 00 00 00 00 00 00 00 
       0000034C 00 00 00 00 00 00 00 00 00 00 
       00000356 00 00 00 00 00 00 00 00 00 00 
       00000360 00 00 00 00 00 00 00 00 00 00 
       0000036A 00 00 00 00 00 00 00 00 00 00 
       00000374 00 00 00 00 00 00 00 00 00 00 
       0000037E 00 00 00 00 00 00 00 00 00 00 
       00000388 00 00 00 00 00 00 00 00 00 00 
       00000392 00 00 00 00 00 00 00 00 00 00 
       0000039C 00 00 00 00 00 00 00 00 00 00 
       000003A6 00 00 00 00 00 00 00 00 00 00 
       000003B0 00 00 00 00 00 00 00 00 00 00 
       000003BA 00 00 00 00 00 00 00 00 00 00 
       000003C4 00 00 00 00 00 00 00 00 00 00 
       000003CE 00 00 00 00 00 00 00 00 00 00 
       000003D8 00 00 00 00 00 00 00 00 00 00 
       000003E2 00 00 00 00 00 00 00 00 00 00 
       000003EC 00 00 00 00 00 00 00 00 00 00 
       000003F6 00 00 00 00 00 00 00 00 00 00 
       00000400 00 00 00 00 00 00 00 00 00 00 
       0000040A 00 00 00 00 00 00 00 00 00 00 
       00000414 00 00 00 00 00 00 00 00 00 00 
       0000041E 00 00 00 00 00 00 00 00 00 00 
       00000428 00 00 00 00 00 00 00 00 00 00 
       00000432 00 00 00 00 00 00 00 00 00 00 
       0000043C 00 00 00 00 
