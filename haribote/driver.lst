     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_HDEntry
     7 00000000                                 	EXTERN	_FSEntry
     8 00000000                                 	EXTERN	_io_cli
     9 00000000                                 	EXTERN	_io_sti
    10 00000000                                 	EXTERN	_task_now
    11 00000000                                 	EXTERN	_memman_alloc_4k
    12 00000000                                 	EXTERN	_set_segmdesc
    13 00000000                                 	EXTERN	_start_sys
    14 00000000                                 	EXTERN	_task_sleep
    15 00000000                                 [FILE "driver.c"]
    16 00000000                                 	GLOBAL	_dDevs
    17                                          [SECTION .data]
    18 00000000                                 LC0:
    19 00000000 49 64 65 20 48 44 00            	DB	"Ide HD",0x00
    20 00000007                                 LC1:
    21 00000007 46 53 00                        	DB	"FS",0x00
    22 0000000A 00 00                           	ALIGNB	4
    23 0000000C                                 _dDevs:
    24 0000000C [00000000]                      	DD	LC0
    25 00000010 [00000000]                      	DD	_HDEntry
    26 00000014 00 00 00 00                     	RESB	4
    27 00000018 [00000007]                      	DD	LC1
    28 0000001C [00000000]                      	DD	_FSEntry
    29 00000020 00 00 00 00                     	RESB	4
    30                                          [SECTION .text]
    31 00000000                                 	GLOBAL	_LDevs
    32 00000000                                 _LDevs:
    33 00000000 55                              	PUSH	EBP
    34 00000001 89 E5                           	MOV	EBP,ESP
    35 00000003 57                              	PUSH	EDI
    36 00000004 56                              	PUSH	ESI
    37 00000005 31 FF                           	XOR	EDI,EDI
    38 00000007 53                              	PUSH	EBX
    39 00000008 31 F6                           	XOR	ESI,ESI
    40 0000000A 83 EC 10                        	SUB	ESP,16
    41 0000000D E8 [00000000]                   	CALL	_io_cli
    42 00000012                                 L7:
    43 00000012 8B 86 [0000000C]                	MOV	EAX,DWORD [_dDevs+ESI]
    44 00000018 8D 5D E4                        	LEA	EBX,DWORD [-28+EBP]
    45 0000001B 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
    46 0000001E 89 9E [00000014]                	MOV	DWORD [_dDevs+8+ESI],EBX
    47 00000024 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    48 00000027 89 45 E8                        	MOV	DWORD [-24+EBP],EAX
    49 0000002A E8 [00000000]                   	CALL	_io_sti
    50 0000002F 53                              	PUSH	EBX
    51 00000030 FF 96 [00000010]                	CALL	DWORD [_dDevs+4+ESI]
    52 00000036 5A                              	POP	EDX
    53 00000037 31 D2                           	XOR	EDX,EDX
    54 00000039 85 C0                           	TEST	EAX,EAX
    55 0000003B 74 13                           	JE	L1
    56 0000003D 47                              	INC	EDI
    57 0000003E 83 C6 0C                        	ADD	ESI,12
    58 00000041 83 FF 01                        	CMP	EDI,1
    59 00000044 7E CC                           	JLE	L7
    60 00000046 E8 [00000000]                   	CALL	_io_sti
    61 0000004B BA 00000001                     	MOV	EDX,1
    62 00000050                                 L1:
    63 00000050 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    64 00000053 89 D0                           	MOV	EAX,EDX
    65 00000055 5B                              	POP	EBX
    66 00000056 5E                              	POP	ESI
    67 00000057 5F                              	POP	EDI
    68 00000058 5D                              	POP	EBP
    69 00000059 C3                              	RET
    70 0000005A                                 	GLOBAL	_load_external_device
    71 0000005A                                 _load_external_device:
    72 0000005A 55                              	PUSH	EBP
    73 0000005B 89 E5                           	MOV	EBP,ESP
    74 0000005D 83 EC 10                        	SUB	ESP,16
    75 00000060 B8 00000001                     	MOV	EAX,1
    76 00000065 C9                              	LEAVE
    77 00000066 C3                              	RET
    78 00000067                                 	GLOBAL	_opensys
    79 00000067                                 _opensys:
    80 00000067 55                              	PUSH	EBP
    81 00000068 89 E5                           	MOV	EBP,ESP
    82 0000006A 57                              	PUSH	EDI
    83 0000006B 56                              	PUSH	ESI
    84 0000006C 53                              	PUSH	EBX
    85 0000006D 83 EC 18                        	SUB	ESP,24
    86 00000070 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
    87 00000073 8B 5D 0C                        	MOV	EBX,DWORD [12+EBP]
    88 00000076 4B                              	DEC	EBX
    89 00000077 E8 [00000000]                   	CALL	_task_now
    90 0000007C 8B 4F 50                        	MOV	ECX,DWORD [80+EDI]
    91 0000007F 8B 57 40                        	MOV	EDX,DWORD [64+EDI]
    92 00000082 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
    93 00000085 8B 37                           	MOV	ESI,DWORD [EDI]
    94 00000087 8B 47 30                        	MOV	EAX,DWORD [48+EDI]
    95 0000008A 89 4D E4                        	MOV	DWORD [-28+EBP],ECX
    96 0000008D 89 55 E8                        	MOV	DWORD [-24+EBP],EDX
    97 00000090 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
    98 00000093 56                              	PUSH	ESI
    99 00000094 4E                              	DEC	ESI
   100 00000095 68 003C0000                     	PUSH	3932160
   101 0000009A E8 [00000000]                   	CALL	_memman_alloc_4k
   102 0000009F 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   103 000000A2 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   104 000000A5 89 82 00000118                  	MOV	DWORD [280+EDX],EAX
   105 000000AB 68 000040BA                     	PUSH	16570
   106 000000B0 57                              	PUSH	EDI
   107 000000B1 53                              	PUSH	EBX
   108 000000B2 BB 00000008                     	MOV	EBX,8
   109 000000B7 8B 02                           	MOV	EAX,DWORD [EDX]
   110 000000B9 99                              	CDQ
   111 000000BA F7 FB                           	IDIV	EBX
   112 000000BC 8D 04 C5 00273E80               	LEA	EAX,DWORD [2571904+EAX*8]
   113 000000C3 50                              	PUSH	EAX
   114 000000C4 E8 [00000000]                   	CALL	_set_segmdesc
   115 000000C9 68 000040B2                     	PUSH	16562
   116 000000CE FF 75 E0                        	PUSH	DWORD [-32+EBP]
   117 000000D1 56                              	PUSH	ESI
   118 000000D2 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   119 000000D5 8B 01                           	MOV	EAX,DWORD [ECX]
   120 000000D7 99                              	CDQ
   121 000000D8 F7 FB                           	IDIV	EBX
   122 000000DA 8D 04 C5 00275DC0               	LEA	EAX,DWORD [2579904+EAX*8]
   123 000000E1 50                              	PUSH	EAX
   124 000000E2 E8 [00000000]                   	CALL	_set_segmdesc
   125 000000E7 83 C4 28                        	ADD	ESP,40
   126 000000EA 83 7D E8 00                     	CMP	DWORD [-24+EBP],0
   127 000000EE 7E 1A                           	JLE	L25
   128 000000F0 8B 5D EC                        	MOV	EBX,DWORD [-20+EBP]
   129 000000F3 8B 45 E4                        	MOV	EAX,DWORD [-28+EBP]
   130 000000F6 03 5D E0                        	ADD	EBX,DWORD [-32+EBP]
   131 000000F9 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   132 000000FC 8D 0C 87                        	LEA	ECX,DWORD [EDI+EAX*4]
   133 000000FF                                 L23:
   134 000000FF 8A 01                           	MOV	AL,BYTE [ECX]
   135 00000101 83 C1 04                        	ADD	ECX,4
   136 00000104 88 03                           	MOV	BYTE [EBX],AL
   137 00000106 43                              	INC	EBX
   138 00000107 4A                              	DEC	EDX
   139 00000108 75 F5                           	JNE	L23
   140 0000010A                                 L25:
   141 0000010A 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   142 0000010D BB 00000008                     	MOV	EBX,8
   143 00000112 83 C0 30                        	ADD	EAX,48
   144 00000115 50                              	PUSH	EAX
   145 00000116 8B 55 F0                        	MOV	EDX,DWORD [-16+EBP]
   146 00000119 8B 02                           	MOV	EAX,DWORD [EDX]
   147 0000011B 99                              	CDQ
   148 0000011C F7 FB                           	IDIV	EBX
   149 0000011E 8D 04 C5 00005DC0               	LEA	EAX,DWORD [24000+EAX*8]
   150 00000125 50                              	PUSH	EAX
   151 00000126 FF 75 EC                        	PUSH	DWORD [-20+EBP]
   152 00000129 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   153 0000012C 8B 01                           	MOV	EAX,DWORD [ECX]
   154 0000012E 99                              	CDQ
   155 0000012F F7 FB                           	IDIV	EBX
   156 00000131 8D 04 C5 00003E80               	LEA	EAX,DWORD [16000+EAX*8]
   157 00000138 50                              	PUSH	EAX
   158 00000139 6A 1B                           	PUSH	27
   159 0000013B E8 [00000000]                   	CALL	_start_sys
   160 00000140 83 C4 14                        	ADD	ESP,20
   161 00000143 E8 [00000000]                   	CALL	_task_now
   162 00000148 89 45 08                        	MOV	DWORD [8+EBP],EAX
   163 0000014B 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   164 0000014E 5B                              	POP	EBX
   165 0000014F 5E                              	POP	ESI
   166 00000150 5F                              	POP	EDI
   167 00000151 5D                              	POP	EBP
   168 00000152 E9 [00000000]                   	JMP	_task_sleep
   169 00000157                                 	GLOBAL	_devcalls
   170                                          [SECTION .data]
   171 00000024 00 00 00 00 00 00 00 00 00 00   	ALIGNB	16
       0000002E 00 00 
   172 00000030                                 _devcalls:
   173 00000030 00 00 00 00 00 00 00 00 00 00   	RESB	40
       0000003A 00 00 00 00 00 00 00 00 00 00 
       00000044 00 00 00 00 00 00 00 00 00 00 
       0000004E 00 00 00 00 00 00 00 00 00 00 
   174 00000058                                 	GLOBAL	_etable
   175                                          [SECTION .data]
   176 00000058                                 _etable:
   177 00000058                                 	RESB	0
