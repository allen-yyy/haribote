     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_out32
     7 00000000                                 	EXTERN	_io_in32
     8 00000000                                 	EXTERN	_io_out8
     9 00000000                                 	EXTERN	_io_out16
    10 00000000                                 	EXTERN	_kalloc
    11 00000000                                 	EXTERN	_list_append
    12 00000000                                 	EXTERN	_printk
    13 00000000                                 	EXTERN	_list_init
    14 00000000                                 	EXTERN	_sprintf
    15 00000000                                 	EXTERN	_cons_putstr0
    16 00000000                                 	EXTERN	_list_traversal
    17 00000000                                 [FILE "pci.c"]
    18 00000000                                 	GLOBAL	_busnum
    19                                          [SECTION .data]
    20 00000000                                 	ALIGNB	4
    21 00000000                                 _busnum:
    22 00000000 00000000                        	DD	0
    23 00000004                                 	GLOBAL	_devnum
    24 00000004                                 	ALIGNB	4
    25 00000004                                 _devnum:
    26 00000004 00000000                        	DD	0
    27                                          [SECTION .text]
    28 00000000                                 	GLOBAL	__pci_read_byte
    29 00000000                                 __pci_read_byte:
    30 00000000 55                              	PUSH	EBP
    31 00000001 89 E5                           	MOV	EBP,ESP
    32 00000003 53                              	PUSH	EBX
    33 00000004 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    34 00000007 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    35 0000000A C1 E0 0B                        	SAL	EAX,11
    36 0000000D 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
    37 00000010 C1 E2 10                        	SAL	EDX,16
    38 00000013 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    39 00000016 C1 E1 08                        	SAL	ECX,8
    40 00000019 09 C2                           	OR	EDX,EAX
    41 0000001B 89 D8                           	MOV	EAX,EBX
    42 0000001D 09 CA                           	OR	EDX,ECX
    43 0000001F 25 000000FC                     	AND	EAX,252
    44 00000024 83 E3 03                        	AND	EBX,3
    45 00000027 09 C2                           	OR	EDX,EAX
    46 00000029 81 CA 80000000                  	OR	EDX,-2147483648
    47 0000002F 52                              	PUSH	EDX
    48 00000030 68 00000CF8                     	PUSH	3320
    49 00000035 E8 [00000000]                   	CALL	_io_out32
    50 0000003A 68 00000CFC                     	PUSH	3324
    51 0000003F E8 [00000000]                   	CALL	_io_in32
    52 00000044 8D 0C DD 00000000               	LEA	ECX,DWORD [0+EBX*8]
    53 0000004B D3 F8                           	SAR	EAX,CL
    54 0000004D 25 000000FF                     	AND	EAX,255
    55 00000052 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
    56 00000055 C9                              	LEAVE
    57 00000056 C3                              	RET
    58 00000057                                 	GLOBAL	__pci_read_word
    59 00000057                                 __pci_read_word:
    60 00000057 55                              	PUSH	EBP
    61 00000058 89 E5                           	MOV	EBP,ESP
    62 0000005A 53                              	PUSH	EBX
    63 0000005B 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    64 0000005E 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    65 00000061 C1 E0 0B                        	SAL	EAX,11
    66 00000064 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
    67 00000067 C1 E2 10                        	SAL	EDX,16
    68 0000006A 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    69 0000006D C1 E1 08                        	SAL	ECX,8
    70 00000070 09 C2                           	OR	EDX,EAX
    71 00000072 89 D8                           	MOV	EAX,EBX
    72 00000074 09 CA                           	OR	EDX,ECX
    73 00000076 25 000000FC                     	AND	EAX,252
    74 0000007B 83 E3 02                        	AND	EBX,2
    75 0000007E 09 C2                           	OR	EDX,EAX
    76 00000080 81 CA 80000000                  	OR	EDX,-2147483648
    77 00000086 52                              	PUSH	EDX
    78 00000087 68 00000CF8                     	PUSH	3320
    79 0000008C E8 [00000000]                   	CALL	_io_out32
    80 00000091 68 00000CFC                     	PUSH	3324
    81 00000096 E8 [00000000]                   	CALL	_io_in32
    82 0000009B 8D 0C DD 00000000               	LEA	ECX,DWORD [0+EBX*8]
    83 000000A2 D3 F8                           	SAR	EAX,CL
    84 000000A4 25 0000FFFF                     	AND	EAX,65535
    85 000000A9 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
    86 000000AC C9                              	LEAVE
    87 000000AD C3                              	RET
    88 000000AE                                 	GLOBAL	__pci_read_dword
    89 000000AE                                 __pci_read_dword:
    90 000000AE 55                              	PUSH	EBP
    91 000000AF 89 E5                           	MOV	EBP,ESP
    92 000000B1 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    93 000000B4 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    94 000000B7 C1 E0 0B                        	SAL	EAX,11
    95 000000BA 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    96 000000BD C1 E2 10                        	SAL	EDX,16
    97 000000C0 C1 E1 08                        	SAL	ECX,8
    98 000000C3 09 C2                           	OR	EDX,EAX
    99 000000C5 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   100 000000C8 09 CA                           	OR	EDX,ECX
   101 000000CA 25 000000FC                     	AND	EAX,252
   102 000000CF 09 C2                           	OR	EDX,EAX
   103 000000D1 81 CA 80000000                  	OR	EDX,-2147483648
   104 000000D7 52                              	PUSH	EDX
   105 000000D8 68 00000CF8                     	PUSH	3320
   106 000000DD E8 [00000000]                   	CALL	_io_out32
   107 000000E2 58                              	POP	EAX
   108 000000E3 5A                              	POP	EDX
   109 000000E4 C7 45 08 00000CFC               	MOV	DWORD [8+EBP],3324
   110 000000EB C9                              	LEAVE
   111 000000EC E9 [00000000]                   	JMP	_io_in32
   112 000000F1                                 	GLOBAL	__pci_write_byte
   113 000000F1                                 __pci_write_byte:
   114 000000F1 55                              	PUSH	EBP
   115 000000F2 89 E5                           	MOV	EBP,ESP
   116 000000F4 53                              	PUSH	EBX
   117 000000F5 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   118 000000F8 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   119 000000FB C1 E0 0B                        	SAL	EAX,11
   120 000000FE 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   121 00000101 C1 E2 10                        	SAL	EDX,16
   122 00000104 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   123 00000107 C1 E1 08                        	SAL	ECX,8
   124 0000010A 09 C2                           	OR	EDX,EAX
   125 0000010C 89 D8                           	MOV	EAX,EBX
   126 0000010E 09 CA                           	OR	EDX,ECX
   127 00000110 25 000000FC                     	AND	EAX,252
   128 00000115 83 E3 03                        	AND	EBX,3
   129 00000118 09 C2                           	OR	EDX,EAX
   130 0000011A 81 C3 00000CFC                  	ADD	EBX,3324
   131 00000120 81 CA 80000000                  	OR	EDX,-2147483648
   132 00000126 52                              	PUSH	EDX
   133 00000127 68 00000CF8                     	PUSH	3320
   134 0000012C E8 [00000000]                   	CALL	_io_out32
   135 00000131 53                              	PUSH	EBX
   136 00000132 0F BE 45 18                     	MOVSX	EAX,BYTE [24+EBP]
   137 00000136 50                              	PUSH	EAX
   138 00000137 E8 [00000000]                   	CALL	_io_out8
   139 0000013C 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   140 0000013F 31 C0                           	XOR	EAX,EAX
   141 00000141 C9                              	LEAVE
   142 00000142 C3                              	RET
   143 00000143                                 	GLOBAL	__pci_write_word
   144 00000143                                 __pci_write_word:
   145 00000143 55                              	PUSH	EBP
   146 00000144 89 E5                           	MOV	EBP,ESP
   147 00000146 53                              	PUSH	EBX
   148 00000147 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   149 0000014A 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   150 0000014D C1 E0 0B                        	SAL	EAX,11
   151 00000150 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   152 00000153 C1 E2 10                        	SAL	EDX,16
   153 00000156 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   154 00000159 C1 E1 08                        	SAL	ECX,8
   155 0000015C 09 C2                           	OR	EDX,EAX
   156 0000015E 89 D8                           	MOV	EAX,EBX
   157 00000160 09 CA                           	OR	EDX,ECX
   158 00000162 25 000000FC                     	AND	EAX,252
   159 00000167 83 E3 02                        	AND	EBX,2
   160 0000016A 09 C2                           	OR	EDX,EAX
   161 0000016C 81 C3 00000CFC                  	ADD	EBX,3324
   162 00000172 81 CA 80000000                  	OR	EDX,-2147483648
   163 00000178 52                              	PUSH	EDX
   164 00000179 68 00000CF8                     	PUSH	3320
   165 0000017E E8 [00000000]                   	CALL	_io_out32
   166 00000183 53                              	PUSH	EBX
   167 00000184 0F BF 45 18                     	MOVSX	EAX,WORD [24+EBP]
   168 00000188 50                              	PUSH	EAX
   169 00000189 E8 [00000000]                   	CALL	_io_out16
   170 0000018E 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   171 00000191 31 C0                           	XOR	EAX,EAX
   172 00000193 C9                              	LEAVE
   173 00000194 C3                              	RET
   174 00000195                                 	GLOBAL	__pci_write_dword
   175 00000195                                 __pci_write_dword:
   176 00000195 55                              	PUSH	EBP
   177 00000196 89 E5                           	MOV	EBP,ESP
   178 00000198 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   179 0000019B 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   180 0000019E C1 E0 0B                        	SAL	EAX,11
   181 000001A1 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   182 000001A4 C1 E2 10                        	SAL	EDX,16
   183 000001A7 C1 E1 08                        	SAL	ECX,8
   184 000001AA 09 C2                           	OR	EDX,EAX
   185 000001AC 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   186 000001AF 09 CA                           	OR	EDX,ECX
   187 000001B1 25 000000FC                     	AND	EAX,252
   188 000001B6 09 C2                           	OR	EDX,EAX
   189 000001B8 81 CA 80000000                  	OR	EDX,-2147483648
   190 000001BE 52                              	PUSH	EDX
   191 000001BF 68 00000CF8                     	PUSH	3320
   192 000001C4 E8 [00000000]                   	CALL	_io_out32
   193 000001C9 68 00000CFC                     	PUSH	3324
   194 000001CE FF 75 18                        	PUSH	DWORD [24+EBP]
   195 000001D1 E8 [00000000]                   	CALL	_io_out32
   196 000001D6 31 C0                           	XOR	EAX,EAX
   197 000001D8 C9                              	LEAVE
   198 000001D9 C3                              	RET
   199 000001DA                                 	GLOBAL	_pci_read_byte
   200 000001DA                                 _pci_read_byte:
   201 000001DA 55                              	PUSH	EBP
   202 000001DB 89 E5                           	MOV	EBP,ESP
   203 000001DD 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   204 000001E0 FF 75 0C                        	PUSH	DWORD [12+EBP]
   205 000001E3 FF 70 10                        	PUSH	DWORD [16+EAX]
   206 000001E6 FF 70 0C                        	PUSH	DWORD [12+EAX]
   207 000001E9 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   208 000001EC FF 30                           	PUSH	DWORD [EAX]
   209 000001EE E8 FFFFFE0D                     	CALL	__pci_read_byte
   210 000001F3 C9                              	LEAVE
   211 000001F4 C3                              	RET
   212 000001F5                                 	GLOBAL	_pci_read_word
   213 000001F5                                 _pci_read_word:
   214 000001F5 55                              	PUSH	EBP
   215 000001F6 89 E5                           	MOV	EBP,ESP
   216 000001F8 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   217 000001FB FF 75 0C                        	PUSH	DWORD [12+EBP]
   218 000001FE FF 70 10                        	PUSH	DWORD [16+EAX]
   219 00000201 FF 70 0C                        	PUSH	DWORD [12+EAX]
   220 00000204 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   221 00000207 FF 30                           	PUSH	DWORD [EAX]
   222 00000209 E8 FFFFFE49                     	CALL	__pci_read_word
   223 0000020E C9                              	LEAVE
   224 0000020F C3                              	RET
   225 00000210                                 	GLOBAL	_pci_read_dword
   226 00000210                                 _pci_read_dword:
   227 00000210 55                              	PUSH	EBP
   228 00000211 89 E5                           	MOV	EBP,ESP
   229 00000213 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   230 00000216 FF 75 0C                        	PUSH	DWORD [12+EBP]
   231 00000219 FF 70 10                        	PUSH	DWORD [16+EAX]
   232 0000021C FF 70 0C                        	PUSH	DWORD [12+EAX]
   233 0000021F 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   234 00000222 FF 30                           	PUSH	DWORD [EAX]
   235 00000224 E8 FFFFFE85                     	CALL	__pci_read_dword
   236 00000229 C9                              	LEAVE
   237 0000022A C3                              	RET
   238 0000022B                                 	GLOBAL	_pci_write_byte
   239 0000022B                                 _pci_write_byte:
   240 0000022B 55                              	PUSH	EBP
   241 0000022C 89 E5                           	MOV	EBP,ESP
   242 0000022E FF 75 10                        	PUSH	DWORD [16+EBP]
   243 00000231 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   244 00000234 FF 75 0C                        	PUSH	DWORD [12+EBP]
   245 00000237 FF 70 10                        	PUSH	DWORD [16+EAX]
   246 0000023A FF 70 0C                        	PUSH	DWORD [12+EAX]
   247 0000023D 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   248 00000240 FF 30                           	PUSH	DWORD [EAX]
   249 00000242 E8 FFFFFEAA                     	CALL	__pci_write_byte
   250 00000247 31 C0                           	XOR	EAX,EAX
   251 00000249 C9                              	LEAVE
   252 0000024A C3                              	RET
   253 0000024B                                 	GLOBAL	_pci_write_word
   254 0000024B                                 _pci_write_word:
   255 0000024B 55                              	PUSH	EBP
   256 0000024C 89 E5                           	MOV	EBP,ESP
   257 0000024E FF 75 10                        	PUSH	DWORD [16+EBP]
   258 00000251 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   259 00000254 FF 75 0C                        	PUSH	DWORD [12+EBP]
   260 00000257 FF 70 10                        	PUSH	DWORD [16+EAX]
   261 0000025A FF 70 0C                        	PUSH	DWORD [12+EAX]
   262 0000025D 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   263 00000260 FF 30                           	PUSH	DWORD [EAX]
   264 00000262 E8 FFFFFEDC                     	CALL	__pci_write_word
   265 00000267 31 C0                           	XOR	EAX,EAX
   266 00000269 C9                              	LEAVE
   267 0000026A C3                              	RET
   268 0000026B                                 	GLOBAL	_pci_write_dword
   269 0000026B                                 _pci_write_dword:
   270 0000026B 55                              	PUSH	EBP
   271 0000026C 89 E5                           	MOV	EBP,ESP
   272 0000026E FF 75 10                        	PUSH	DWORD [16+EBP]
   273 00000271 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   274 00000274 FF 75 0C                        	PUSH	DWORD [12+EBP]
   275 00000277 FF 70 10                        	PUSH	DWORD [16+EAX]
   276 0000027A FF 70 0C                        	PUSH	DWORD [12+EAX]
   277 0000027D 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   278 00000280 FF 30                           	PUSH	DWORD [EAX]
   279 00000282 E8 FFFFFF0E                     	CALL	__pci_write_dword
   280 00000287 31 C0                           	XOR	EAX,EAX
   281 00000289 C9                              	LEAVE
   282 0000028A C3                              	RET
   283 0000028B                                 	GLOBAL	_pci_add_dev
   284 0000028B                                 _pci_add_dev:
   285 0000028B 55                              	PUSH	EBP
   286 0000028C 89 E5                           	MOV	EBP,ESP
   287 0000028E 56                              	PUSH	ESI
   288 0000028F 53                              	PUSH	EBX
   289 00000290 6A 7C                           	PUSH	124
   290 00000292 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   291 00000295 E8 [00000000]                   	CALL	_kalloc
   292 0000029A 89 C3                           	MOV	EBX,EAX
   293 0000029C 8B 46 08                        	MOV	EAX,DWORD [8+ESI]
   294 0000029F 89 43 08                        	MOV	DWORD [8+EBX],EAX
   295 000002A2 8B 46 0C                        	MOV	EAX,DWORD [12+ESI]
   296 000002A5 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   297 000002A8 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   298 000002AB 89 43 10                        	MOV	DWORD [16+EBX],EAX
   299 000002AE 8A 46 18                        	MOV	AL,BYTE [24+ESI]
   300 000002B1 88 43 18                        	MOV	BYTE [24+EBX],AL
   301 000002B4 6A 00                           	PUSH	0
   302 000002B6 FF 73 10                        	PUSH	DWORD [16+EBX]
   303 000002B9 FF 73 0C                        	PUSH	DWORD [12+EBX]
   304 000002BC 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   305 000002BF FF 30                           	PUSH	DWORD [EAX]
   306 000002C1 E8 FFFFFD91                     	CALL	__pci_read_word
   307 000002C6 66 89 43 14                     	MOV	WORD [20+EBX],AX
   308 000002CA 6A 02                           	PUSH	2
   309 000002CC FF 73 10                        	PUSH	DWORD [16+EBX]
   310 000002CF FF 73 0C                        	PUSH	DWORD [12+EBX]
   311 000002D2 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   312 000002D5 FF 30                           	PUSH	DWORD [EAX]
   313 000002D7 E8 FFFFFD7B                     	CALL	__pci_read_word
   314 000002DC 83 C4 24                        	ADD	ESP,36
   315 000002DF 66 89 43 16                     	MOV	WORD [22+EBX],AX
   316 000002E3 6A 08                           	PUSH	8
   317 000002E5 FF 73 10                        	PUSH	DWORD [16+EBX]
   318 000002E8 FF 73 0C                        	PUSH	DWORD [12+EBX]
   319 000002EB 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   320 000002EE FF 30                           	PUSH	DWORD [EAX]
   321 000002F0 E8 FFFFFDB9                     	CALL	__pci_read_dword
   322 000002F5 89 43 1C                        	MOV	DWORD [28+EBX],EAX
   323 000002F8 53                              	PUSH	EBX
   324 000002F9 68 [00000040]                   	PUSH	_pci_dev_list
   325 000002FE E8 [00000000]                   	CALL	_list_append
   326 00000303 89 D8                           	MOV	EAX,EBX
   327 00000305 FF 05 [00000004]                	INC	DWORD [_devnum]
   328 0000030B 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   329 0000030E 5B                              	POP	EBX
   330 0000030F 5E                              	POP	ESI
   331 00000310 5D                              	POP	EBP
   332 00000311 C3                              	RET
   333                                          [SECTION .data]
   334 00000008                                 LC0:
   335 00000008 61 64 64 20 64 65 76 20 25 58   	DB	"add dev %X %4X %d %d %d 0x%X %d",0x0A,0x00
       00000012 20 25 34 58 20 25 64 20 25 64 
       0000001C 20 25 64 20 30 78 25 58 20 25 
       00000026 64 0A 00 
   336                                          [SECTION .text]
   337 00000312                                 	GLOBAL	_pci_check_func
   338 00000312                                 _pci_check_func:
   339 00000312 55                              	PUSH	EBP
   340 00000313 89 E5                           	MOV	EBP,ESP
   341 00000315 57                              	PUSH	EDI
   342 00000316 56                              	PUSH	ESI
   343 00000317 53                              	PUSH	EBX
   344 00000318 83 C4 80                        	ADD	ESP,-128
   345 0000031B 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
   346 0000031E 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   347 00000321 6A 0E                           	PUSH	14
   348 00000323 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   349 00000326 53                              	PUSH	EBX
   350 00000327 89 75 80                        	MOV	DWORD [-128+EBP],ESI
   351 0000032A 56                              	PUSH	ESI
   352 0000032B 8B 04 BD [00000060]             	MOV	EAX,DWORD [_bus_list+EDI*4]
   353 00000332 57                              	PUSH	EDI
   354 00000333 89 85 FFFFFF7C                  	MOV	DWORD [-132+EBP],EAX
   355 00000339 89 5D 84                        	MOV	DWORD [-124+EBP],EBX
   356 0000033C E8 FFFFFCBF                     	CALL	__pci_read_byte
   357 00000341 88 45 8C                        	MOV	BYTE [-116+EBP],AL
   358 00000344 8D 85 FFFFFF74                  	LEA	EAX,DWORD [-140+EBP]
   359 0000034A 50                              	PUSH	EAX
   360 0000034B E8 FFFFFF3B                     	CALL	_pci_add_dev
   361 00000350 FF 35 [00000004]                	PUSH	DWORD [_devnum]
   362 00000356 FF 70 1C                        	PUSH	DWORD [28+EAX]
   363 00000359 53                              	PUSH	EBX
   364 0000035A 56                              	PUSH	ESI
   365 0000035B 8B 50 08                        	MOV	EDX,DWORD [8+EAX]
   366 0000035E FF 32                           	PUSH	DWORD [EDX]
   367 00000360 0F BF 50 16                     	MOVSX	EDX,WORD [22+EAX]
   368 00000364 52                              	PUSH	EDX
   369 00000365 0F B7 40 14                     	MOVZX	EAX,WORD [20+EAX]
   370 00000369 50                              	PUSH	EAX
   371 0000036A 68 [00000008]                   	PUSH	LC0
   372 0000036F E8 [00000000]                   	CALL	_printk
   373 00000374 83 C4 34                        	ADD	ESP,52
   374 00000377 6A 0A                           	PUSH	10
   375 00000379 53                              	PUSH	EBX
   376 0000037A 56                              	PUSH	ESI
   377 0000037B 57                              	PUSH	EDI
   378 0000037C E8 FFFFFCD6                     	CALL	__pci_read_word
   379 00000381 83 C4 10                        	ADD	ESP,16
   380 00000384 3D 00000604                     	CMP	EAX,1540
   381 00000389 74 08                           	JE	L16
   382 0000038B                                 L14:
   383 0000038B 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   384 0000038E 5B                              	POP	EBX
   385 0000038F 5E                              	POP	ESI
   386 00000390 5F                              	POP	EDI
   387 00000391 5D                              	POP	EBP
   388 00000392 C3                              	RET
   389 00000393                                 L16:
   390 00000393 6A 19                           	PUSH	25
   391 00000395 53                              	PUSH	EBX
   392 00000396 56                              	PUSH	ESI
   393 00000397 57                              	PUSH	EDI
   394 00000398 E8 FFFFFC63                     	CALL	__pci_read_byte
   395 0000039D 83 C4 10                        	ADD	ESP,16
   396 000003A0 50                              	PUSH	EAX
   397 000003A1 E8 0000009B                     	CALL	_pci_scan_bus
   398 000003A6 59                              	POP	ECX
   399 000003A7 EB E2                           	JMP	L14
   400 000003A9                                 	GLOBAL	_pci_check_dev
   401 000003A9                                 _pci_check_dev:
   402 000003A9 55                              	PUSH	EBP
   403 000003AA 89 E5                           	MOV	EBP,ESP
   404 000003AC 57                              	PUSH	EDI
   405 000003AD 56                              	PUSH	ESI
   406 000003AE 53                              	PUSH	EBX
   407 000003AF 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   408 000003B2 6A 00                           	PUSH	0
   409 000003B4 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   410 000003B7 6A 00                           	PUSH	0
   411 000003B9 56                              	PUSH	ESI
   412 000003BA 57                              	PUSH	EDI
   413 000003BB E8 FFFFFC97                     	CALL	__pci_read_word
   414 000003C0 83 C4 10                        	ADD	ESP,16
   415 000003C3 3D 0000FFFF                     	CMP	EAX,65535
   416 000003C8 74 12                           	JE	L17
   417 000003CA 6A 00                           	PUSH	0
   418 000003CC 6A 00                           	PUSH	0
   419 000003CE 56                              	PUSH	ESI
   420 000003CF 57                              	PUSH	EDI
   421 000003D0 E8 FFFFFC82                     	CALL	__pci_read_word
   422 000003D5 83 C4 10                        	ADD	ESP,16
   423 000003D8 85 C0                           	TEST	EAX,EAX
   424 000003DA 75 08                           	JNE	L29
   425 000003DC                                 L17:
   426 000003DC 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   427 000003DF 5B                              	POP	EBX
   428 000003E0 5E                              	POP	ESI
   429 000003E1 5F                              	POP	EDI
   430 000003E2 5D                              	POP	EBP
   431 000003E3 C3                              	RET
   432 000003E4                                 L29:
   433 000003E4 6A 0E                           	PUSH	14
   434 000003E6 6A 00                           	PUSH	0
   435 000003E8 56                              	PUSH	ESI
   436 000003E9 57                              	PUSH	EDI
   437 000003EA E8 FFFFFC11                     	CALL	__pci_read_byte
   438 000003EF 83 C4 10                        	ADD	ESP,16
   439 000003F2 83 E0 01                        	AND	EAX,1
   440 000003F5 74 3C                           	JE	L20
   441 000003F7 31 DB                           	XOR	EBX,EBX
   442 000003F9                                 L26:
   443 000003F9 6A 00                           	PUSH	0
   444 000003FB 53                              	PUSH	EBX
   445 000003FC 56                              	PUSH	ESI
   446 000003FD 57                              	PUSH	EDI
   447 000003FE E8 FFFFFC54                     	CALL	__pci_read_word
   448 00000403 83 C4 10                        	ADD	ESP,16
   449 00000406 3D 0000FFFF                     	CMP	EAX,65535
   450 0000040B 74 11                           	JE	L23
   451 0000040D 6A 00                           	PUSH	0
   452 0000040F 53                              	PUSH	EBX
   453 00000410 56                              	PUSH	ESI
   454 00000411 57                              	PUSH	EDI
   455 00000412 E8 FFFFFC40                     	CALL	__pci_read_word
   456 00000417 83 C4 10                        	ADD	ESP,16
   457 0000041A 85 C0                           	TEST	EAX,EAX
   458 0000041C 75 08                           	JNE	L30
   459 0000041E                                 L23:
   460 0000041E 43                              	INC	EBX
   461 0000041F 83 FB 07                        	CMP	EBX,7
   462 00000422 7E D5                           	JLE	L26
   463 00000424 EB B6                           	JMP	L17
   464 00000426                                 L30:
   465 00000426 53                              	PUSH	EBX
   466 00000427 56                              	PUSH	ESI
   467 00000428 57                              	PUSH	EDI
   468 00000429 E8 FFFFFEE4                     	CALL	_pci_check_func
   469 0000042E 83 C4 0C                        	ADD	ESP,12
   470 00000431 EB EB                           	JMP	L23
   471 00000433                                 L20:
   472 00000433 6A 00                           	PUSH	0
   473 00000435 56                              	PUSH	ESI
   474 00000436 57                              	PUSH	EDI
   475 00000437 E8 FFFFFED6                     	CALL	_pci_check_func
   476 0000043C 83 C4 0C                        	ADD	ESP,12
   477 0000043F EB 9B                           	JMP	L17
   478 00000441                                 	GLOBAL	_pci_scan_bus
   479 00000441                                 _pci_scan_bus:
   480 00000441 55                              	PUSH	EBP
   481 00000442 89 E5                           	MOV	EBP,ESP
   482 00000444 56                              	PUSH	ESI
   483 00000445 53                              	PUSH	EBX
   484 00000446 31 DB                           	XOR	EBX,EBX
   485 00000448 83 EC 30                        	SUB	ESP,48
   486 0000044B 8D 45 C8                        	LEA	EAX,DWORD [-56+EBP]
   487 0000044E 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   488 00000451 89 75 C8                        	MOV	DWORD [-56+EBP],ESI
   489 00000454 89 75 D0                        	MOV	DWORD [-48+EBP],ESI
   490 00000457 89 75 CC                        	MOV	DWORD [-52+EBP],ESI
   491 0000045A 89 04 B5 [00000060]             	MOV	DWORD [_bus_list+ESI*4],EAX
   492 00000461                                 L36:
   493 00000461 53                              	PUSH	EBX
   494 00000462 43                              	INC	EBX
   495 00000463 56                              	PUSH	ESI
   496 00000464 E8 FFFFFF40                     	CALL	_pci_check_dev
   497 00000469 83 FB 1F                        	CMP	EBX,31
   498 0000046C 58                              	POP	EAX
   499 0000046D 5A                              	POP	EDX
   500 0000046E 7E F1                           	JLE	L36
   501 00000470 FF 05 [00000000]                	INC	DWORD [_busnum]
   502 00000476 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   503 00000479 5B                              	POP	EBX
   504 0000047A 5E                              	POP	ESI
   505 0000047B 5D                              	POP	EBP
   506 0000047C C3                              	RET
   507 0000047D                                 	GLOBAL	_pci_probe
   508 0000047D                                 _pci_probe:
   509 0000047D 55                              	PUSH	EBP
   510 0000047E 89 E5                           	MOV	EBP,ESP
   511 00000480 6A 00                           	PUSH	0
   512 00000482 6A 00                           	PUSH	0
   513 00000484 6A 00                           	PUSH	0
   514 00000486 6A 00                           	PUSH	0
   515 00000488 E8 FFFFFC21                     	CALL	__pci_read_dword
   516 0000048D 83 C4 10                        	ADD	ESP,16
   517 00000490 40                              	INC	EAX
   518 00000491 0F 95 C0                        	SETNE	AL
   519 00000494 0F B6 C0                        	MOVZX	EAX,AL
   520 00000497 C9                              	LEAVE
   521 00000498 C3                              	RET
   522 00000499                                 	GLOBAL	_pci_init
   523 00000499                                 _pci_init:
   524 00000499 55                              	PUSH	EBP
   525 0000049A 89 E5                           	MOV	EBP,ESP
   526 0000049C E8 FFFFFFDC                     	CALL	_pci_probe
   527 000004A1 31 D2                           	XOR	EDX,EDX
   528 000004A3 85 C0                           	TEST	EAX,EAX
   529 000004A5 75 04                           	JNE	L43
   530 000004A7                                 L41:
   531 000004A7 89 D0                           	MOV	EAX,EDX
   532 000004A9 C9                              	LEAVE
   533 000004AA C3                              	RET
   534 000004AB                                 L43:
   535 000004AB 68 [00000050]                   	PUSH	_pci_bus_list
   536 000004B0 E8 [00000000]                   	CALL	_list_init
   537 000004B5 68 [00000040]                   	PUSH	_pci_dev_list
   538 000004BA E8 [00000000]                   	CALL	_list_init
   539 000004BF 6A 00                           	PUSH	0
   540 000004C1 E8 FFFFFF7B                     	CALL	_pci_scan_bus
   541 000004C6 BA 00000001                     	MOV	EDX,1
   542 000004CB EB DA                           	JMP	L41
   543                                          [SECTION .data]
   544 00000029                                 LC1:
   545 00000029 25 34 78 20 25 34 78 20 25 64   	DB	"%4x %4x %d %d %d",0x0A,0x00
       00000033 20 25 64 20 25 64 0A 00 
   546                                          [SECTION .text]
   547 000004CD                                 	GLOBAL	_pci_test_f
   548 000004CD                                 _pci_test_f:
   549 000004CD 55                              	PUSH	EBP
   550 000004CE 89 E5                           	MOV	EBP,ESP
   551 000004D0 53                              	PUSH	EBX
   552 000004D1 81 EC 000003F0                  	SUB	ESP,1008
   553 000004D7 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   554 000004DA 8D 9D FFFFFC0C                  	LEA	EBX,DWORD [-1012+EBP]
   555 000004E0 FF 72 10                        	PUSH	DWORD [16+EDX]
   556 000004E3 FF 72 0C                        	PUSH	DWORD [12+EDX]
   557 000004E6 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   558 000004E9 FF 30                           	PUSH	DWORD [EAX]
   559 000004EB 0F BF 42 16                     	MOVSX	EAX,WORD [22+EDX]
   560 000004EF 50                              	PUSH	EAX
   561 000004F0 0F BF 42 14                     	MOVSX	EAX,WORD [20+EDX]
   562 000004F4 50                              	PUSH	EAX
   563 000004F5 68 [00000029]                   	PUSH	LC1
   564 000004FA 53                              	PUSH	EBX
   565 000004FB E8 [00000000]                   	CALL	_sprintf
   566 00000500 53                              	PUSH	EBX
   567 00000501 FF 75 0C                        	PUSH	DWORD [12+EBP]
   568 00000504 E8 [00000000]                   	CALL	_cons_putstr0
   569 00000509 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   570 0000050C 31 C0                           	XOR	EAX,EAX
   571 0000050E C9                              	LEAVE
   572 0000050F C3                              	RET
   573                                          [SECTION .data]
   574 0000003B                                 LC2:
   575 0000003B 25 64 0A 0A 00                  	DB	"%d",0x0A,0x0A,0x00
   576                                          [SECTION .text]
   577 00000510                                 	GLOBAL	_pci_test
   578 00000510                                 _pci_test:
   579 00000510 55                              	PUSH	EBP
   580 00000511 89 E5                           	MOV	EBP,ESP
   581 00000513 56                              	PUSH	ESI
   582 00000514 53                              	PUSH	EBX
   583 00000515 83 EC 70                        	SUB	ESP,112
   584 00000518 8D 5D 88                        	LEA	EBX,DWORD [-120+EBP]
   585 0000051B 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   586 0000051E 56                              	PUSH	ESI
   587 0000051F 68 [000004CD]                   	PUSH	_pci_test_f
   588 00000524 68 [00000040]                   	PUSH	_pci_dev_list
   589 00000529 E8 [00000000]                   	CALL	_list_traversal
   590 0000052E FF 35 [00000000]                	PUSH	DWORD [_busnum]
   591 00000534 68 [0000003B]                   	PUSH	LC2
   592 00000539 53                              	PUSH	EBX
   593 0000053A E8 [00000000]                   	CALL	_sprintf
   594 0000053F 53                              	PUSH	EBX
   595 00000540 56                              	PUSH	ESI
   596 00000541 E8 [00000000]                   	CALL	_cons_putstr0
   597 00000546 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   598 00000549 5B                              	POP	EBX
   599 0000054A 5E                              	POP	ESI
   600 0000054B 5D                              	POP	EBP
   601 0000054C C3                              	RET
   602 0000054D                                 	GLOBAL	_PCIEntry
   603 0000054D                                 _PCIEntry:
   604 0000054D 55                              	PUSH	EBP
   605 0000054E 89 E5                           	MOV	EBP,ESP
   606 00000550 E8 FFFFFF44                     	CALL	_pci_init
   607 00000555 5D                              	POP	EBP
   608 00000556 B8 00000001                     	MOV	EAX,1
   609 0000055B C3                              	RET
   610 0000055C                                 	GLOBAL	_pci_dev_list
   611                                          [SECTION .data]
   612 00000040                                 	ALIGNB	16
   613 00000040                                 _pci_dev_list:
   614 00000040 00 00 00 00 00 00 00 00 00 00   	RESB	16
       0000004A 00 00 00 00 00 00 
   615 00000050                                 	GLOBAL	_pci_bus_list
   616                                          [SECTION .data]
   617 00000050                                 	ALIGNB	16
   618 00000050                                 _pci_bus_list:
   619 00000050 00 00 00 00 00 00 00 00 00 00   	RESB	16
       0000005A 00 00 00 00 00 00 
   620 00000060                                 	GLOBAL	_bus_list
   621                                          [SECTION .data]
   622 00000060                                 	ALIGNB	16
   623 00000060                                 _bus_list:
   624 00000060 00 00 00 00 00 00 00 00 00 00   	RESB	1024
       0000006A 00 00 00 00 00 00 00 00 00 00 
       00000074 00 00 00 00 00 00 00 00 00 00 
       0000007E 00 00 00 00 00 00 00 00 00 00 
       00000088 00 00 00 00 00 00 00 00 00 00 
       00000092 00 00 00 00 00 00 00 00 00 00 
       0000009C 00 00 00 00 00 00 00 00 00 00 
       000000A6 00 00 00 00 00 00 00 00 00 00 
       000000B0 00 00 00 00 00 00 00 00 00 00 
       000000BA 00 00 00 00 00 00 00 00 00 00 
       000000C4 00 00 00 00 00 00 00 00 00 00 
       000000CE 00 00 00 00 00 00 00 00 00 00 
       000000D8 00 00 00 00 00 00 00 00 00 00 
       000000E2 00 00 00 00 00 00 00 00 00 00 
       000000EC 00 00 00 00 00 00 00 00 00 00 
       000000F6 00 00 00 00 00 00 00 00 00 00 
       00000100 00 00 00 00 00 00 00 00 00 00 
       0000010A 00 00 00 00 00 00 00 00 00 00 
       00000114 00 00 00 00 00 00 00 00 00 00 
       0000011E 00 00 00 00 00 00 00 00 00 00 
       00000128 00 00 00 00 00 00 00 00 00 00 
       00000132 00 00 00 00 00 00 00 00 00 00 
       0000013C 00 00 00 00 00 00 00 00 00 00 
       00000146 00 00 00 00 00 00 00 00 00 00 
       00000150 00 00 00 00 00 00 00 00 00 00 
       0000015A 00 00 00 00 00 00 00 00 00 00 
       00000164 00 00 00 00 00 00 00 00 00 00 
       0000016E 00 00 00 00 00 00 00 00 00 00 
       00000178 00 00 00 00 00 00 00 00 00 00 
       00000182 00 00 00 00 00 00 00 00 00 00 
       0000018C 00 00 00 00 00 00 00 00 00 00 
       00000196 00 00 00 00 00 00 00 00 00 00 
       000001A0 00 00 00 00 00 00 00 00 00 00 
       000001AA 00 00 00 00 00 00 00 00 00 00 
       000001B4 00 00 00 00 00 00 00 00 00 00 
       000001BE 00 00 00 00 00 00 00 00 00 00 
       000001C8 00 00 00 00 00 00 00 00 00 00 
       000001D2 00 00 00 00 00 00 00 00 00 00 
       000001DC 00 00 00 00 00 00 00 00 00 00 
       000001E6 00 00 00 00 00 00 00 00 00 00 
       000001F0 00 00 00 00 00 00 00 00 00 00 
       000001FA 00 00 00 00 00 00 00 00 00 00 
       00000204 00 00 00 00 00 00 00 00 00 00 
       0000020E 00 00 00 00 00 00 00 00 00 00 
       00000218 00 00 00 00 00 00 00 00 00 00 
       00000222 00 00 00 00 00 00 00 00 00 00 
       0000022C 00 00 00 00 00 00 00 00 00 00 
       00000236 00 00 00 00 00 00 00 00 00 00 
       00000240 00 00 00 00 00 00 00 00 00 00 
       0000024A 00 00 00 00 00 00 00 00 00 00 
       00000254 00 00 00 00 00 00 00 00 00 00 
       0000025E 00 00 00 00 00 00 00 00 00 00 
       00000268 00 00 00 00 00 00 00 00 00 00 
       00000272 00 00 00 00 00 00 00 00 00 00 
       0000027C 00 00 00 00 00 00 00 00 00 00 
       00000286 00 00 00 00 00 00 00 00 00 00 
       00000290 00 00 00 00 00 00 00 00 00 00 
       0000029A 00 00 00 00 00 00 00 00 00 00 
       000002A4 00 00 00 00 00 00 00 00 00 00 
       000002AE 00 00 00 00 00 00 00 00 00 00 
       000002B8 00 00 00 00 00 00 00 00 00 00 
       000002C2 00 00 00 00 00 00 00 00 00 00 
       000002CC 00 00 00 00 00 00 00 00 00 00 
       000002D6 00 00 00 00 00 00 00 00 00 00 
       000002E0 00 00 00 00 00 00 00 00 00 00 
       000002EA 00 00 00 00 00 00 00 00 00 00 
       000002F4 00 00 00 00 00 00 00 00 00 00 
       000002FE 00 00 00 00 00 00 00 00 00 00 
       00000308 00 00 00 00 00 00 00 00 00 00 
       00000312 00 00 00 00 00 00 00 00 00 00 
       0000031C 00 00 00 00 00 00 00 00 00 00 
       00000326 00 00 00 00 00 00 00 00 00 00 
       00000330 00 00 00 00 00 00 00 00 00 00 
       0000033A 00 00 00 00 00 00 00 00 00 00 
       00000344 00 00 00 00 00 00 00 00 00 00 
       0000034E 00 00 00 00 00 00 00 00 00 00 
       00000358 00 00 00 00 00 00 00 00 00 00 
       00000362 00 00 00 00 00 00 00 00 00 00 
       0000036C 00 00 00 00 00 00 00 00 00 00 
       00000376 00 00 00 00 00 00 00 00 00 00 
       00000380 00 00 00 00 00 00 00 00 00 00 
       0000038A 00 00 00 00 00 00 00 00 00 00 
       00000394 00 00 00 00 00 00 00 00 00 00 
       0000039E 00 00 00 00 00 00 00 00 00 00 
       000003A8 00 00 00 00 00 00 00 00 00 00 
       000003B2 00 00 00 00 00 00 00 00 00 00 
       000003BC 00 00 00 00 00 00 00 00 00 00 
       000003C6 00 00 00 00 00 00 00 00 00 00 
       000003D0 00 00 00 00 00 00 00 00 00 00 
       000003DA 00 00 00 00 00 00 00 00 00 00 
       000003E4 00 00 00 00 00 00 00 00 00 00 
       000003EE 00 00 00 00 00 00 00 00 00 00 
       000003F8 00 00 00 00 00 00 00 00 00 00 
       00000402 00 00 00 00 00 00 00 00 00 00 
       0000040C 00 00 00 00 00 00 00 00 00 00 
       00000416 00 00 00 00 00 00 00 00 00 00 
       00000420 00 00 00 00 00 00 00 00 00 00 
       0000042A 00 00 00 00 00 00 00 00 00 00 
       00000434 00 00 00 00 00 00 00 00 00 00 
       0000043E 00 00 00 00 00 00 00 00 00 00 
       00000448 00 00 00 00 00 00 00 00 00 00 
       00000452 00 00 00 00 00 00 00 00 00 00 
       0000045C 00 00 00 00 
