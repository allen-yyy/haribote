     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_io_out32
     7 00000000                                 	EXTERN	_io_in32
     8 00000000                                 	EXTERN	_io_out8
     9 00000000                                 	EXTERN	_io_out16
    10 00000000                                 	EXTERN	_kalloc
    11 00000000                                 	EXTERN	_list_append
    12 00000000                                 	EXTERN	_list_init
    13 00000000                                 	EXTERN	_sprintf
    14 00000000                                 	EXTERN	_cons_putstr0
    15 00000000                                 	EXTERN	_list_traversal
    16 00000000                                 [FILE "pci.c"]
    17 00000000                                 	GLOBAL	_busnum
    18                                          [SECTION .data]
    19 00000000                                 	ALIGNB	4
    20 00000000                                 _busnum:
    21 00000000 00000000                        	DD	0
    22 00000004                                 	GLOBAL	_devnum
    23 00000004                                 	ALIGNB	4
    24 00000004                                 _devnum:
    25 00000004 00000000                        	DD	0
    26                                          [SECTION .text]
    27 00000000                                 	GLOBAL	__pci_read_byte
    28 00000000                                 __pci_read_byte:
    29 00000000 55                              	PUSH	EBP
    30 00000001 89 E5                           	MOV	EBP,ESP
    31 00000003 53                              	PUSH	EBX
    32 00000004 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    33 00000007 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    34 0000000A C1 E0 0B                        	SAL	EAX,11
    35 0000000D 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
    36 00000010 C1 E2 10                        	SAL	EDX,16
    37 00000013 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    38 00000016 C1 E1 08                        	SAL	ECX,8
    39 00000019 09 C2                           	OR	EDX,EAX
    40 0000001B 89 D8                           	MOV	EAX,EBX
    41 0000001D 09 CA                           	OR	EDX,ECX
    42 0000001F 25 000000FC                     	AND	EAX,252
    43 00000024 83 E3 03                        	AND	EBX,3
    44 00000027 09 C2                           	OR	EDX,EAX
    45 00000029 81 CA 80000000                  	OR	EDX,-2147483648
    46 0000002F 52                              	PUSH	EDX
    47 00000030 68 00000CF8                     	PUSH	3320
    48 00000035 E8 [00000000]                   	CALL	_io_out32
    49 0000003A 68 00000CFC                     	PUSH	3324
    50 0000003F E8 [00000000]                   	CALL	_io_in32
    51 00000044 8D 0C DD 00000000               	LEA	ECX,DWORD [0+EBX*8]
    52 0000004B D3 F8                           	SAR	EAX,CL
    53 0000004D 25 000000FF                     	AND	EAX,255
    54 00000052 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
    55 00000055 C9                              	LEAVE
    56 00000056 C3                              	RET
    57 00000057                                 	GLOBAL	__pci_read_word
    58 00000057                                 __pci_read_word:
    59 00000057 55                              	PUSH	EBP
    60 00000058 89 E5                           	MOV	EBP,ESP
    61 0000005A 53                              	PUSH	EBX
    62 0000005B 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    63 0000005E 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    64 00000061 C1 E0 0B                        	SAL	EAX,11
    65 00000064 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
    66 00000067 C1 E2 10                        	SAL	EDX,16
    67 0000006A 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    68 0000006D C1 E1 08                        	SAL	ECX,8
    69 00000070 09 C2                           	OR	EDX,EAX
    70 00000072 89 D8                           	MOV	EAX,EBX
    71 00000074 09 CA                           	OR	EDX,ECX
    72 00000076 25 000000FC                     	AND	EAX,252
    73 0000007B 83 E3 02                        	AND	EBX,2
    74 0000007E 09 C2                           	OR	EDX,EAX
    75 00000080 81 CA 80000000                  	OR	EDX,-2147483648
    76 00000086 52                              	PUSH	EDX
    77 00000087 68 00000CF8                     	PUSH	3320
    78 0000008C E8 [00000000]                   	CALL	_io_out32
    79 00000091 68 00000CFC                     	PUSH	3324
    80 00000096 E8 [00000000]                   	CALL	_io_in32
    81 0000009B 8D 0C DD 00000000               	LEA	ECX,DWORD [0+EBX*8]
    82 000000A2 D3 F8                           	SAR	EAX,CL
    83 000000A4 25 0000FFFF                     	AND	EAX,65535
    84 000000A9 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
    85 000000AC C9                              	LEAVE
    86 000000AD C3                              	RET
    87 000000AE                                 	GLOBAL	__pci_read_dword
    88 000000AE                                 __pci_read_dword:
    89 000000AE 55                              	PUSH	EBP
    90 000000AF 89 E5                           	MOV	EBP,ESP
    91 000000B1 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    92 000000B4 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    93 000000B7 C1 E0 0B                        	SAL	EAX,11
    94 000000BA 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
    95 000000BD C1 E2 10                        	SAL	EDX,16
    96 000000C0 C1 E1 08                        	SAL	ECX,8
    97 000000C3 09 C2                           	OR	EDX,EAX
    98 000000C5 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    99 000000C8 09 CA                           	OR	EDX,ECX
   100 000000CA 25 000000FC                     	AND	EAX,252
   101 000000CF 09 C2                           	OR	EDX,EAX
   102 000000D1 81 CA 80000000                  	OR	EDX,-2147483648
   103 000000D7 52                              	PUSH	EDX
   104 000000D8 68 00000CF8                     	PUSH	3320
   105 000000DD E8 [00000000]                   	CALL	_io_out32
   106 000000E2 58                              	POP	EAX
   107 000000E3 5A                              	POP	EDX
   108 000000E4 C7 45 08 00000CFC               	MOV	DWORD [8+EBP],3324
   109 000000EB C9                              	LEAVE
   110 000000EC E9 [00000000]                   	JMP	_io_in32
   111 000000F1                                 	GLOBAL	__pci_write_byte
   112 000000F1                                 __pci_write_byte:
   113 000000F1 55                              	PUSH	EBP
   114 000000F2 89 E5                           	MOV	EBP,ESP
   115 000000F4 53                              	PUSH	EBX
   116 000000F5 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   117 000000F8 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   118 000000FB C1 E0 0B                        	SAL	EAX,11
   119 000000FE 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   120 00000101 C1 E2 10                        	SAL	EDX,16
   121 00000104 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   122 00000107 C1 E1 08                        	SAL	ECX,8
   123 0000010A 09 C2                           	OR	EDX,EAX
   124 0000010C 89 D8                           	MOV	EAX,EBX
   125 0000010E 09 CA                           	OR	EDX,ECX
   126 00000110 25 000000FC                     	AND	EAX,252
   127 00000115 83 E3 03                        	AND	EBX,3
   128 00000118 09 C2                           	OR	EDX,EAX
   129 0000011A 81 C3 00000CFC                  	ADD	EBX,3324
   130 00000120 81 CA 80000000                  	OR	EDX,-2147483648
   131 00000126 52                              	PUSH	EDX
   132 00000127 68 00000CF8                     	PUSH	3320
   133 0000012C E8 [00000000]                   	CALL	_io_out32
   134 00000131 53                              	PUSH	EBX
   135 00000132 0F BE 45 18                     	MOVSX	EAX,BYTE [24+EBP]
   136 00000136 50                              	PUSH	EAX
   137 00000137 E8 [00000000]                   	CALL	_io_out8
   138 0000013C 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   139 0000013F 31 C0                           	XOR	EAX,EAX
   140 00000141 C9                              	LEAVE
   141 00000142 C3                              	RET
   142 00000143                                 	GLOBAL	__pci_write_word
   143 00000143                                 __pci_write_word:
   144 00000143 55                              	PUSH	EBP
   145 00000144 89 E5                           	MOV	EBP,ESP
   146 00000146 53                              	PUSH	EBX
   147 00000147 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   148 0000014A 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   149 0000014D C1 E0 0B                        	SAL	EAX,11
   150 00000150 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   151 00000153 C1 E2 10                        	SAL	EDX,16
   152 00000156 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   153 00000159 C1 E1 08                        	SAL	ECX,8
   154 0000015C 09 C2                           	OR	EDX,EAX
   155 0000015E 89 D8                           	MOV	EAX,EBX
   156 00000160 09 CA                           	OR	EDX,ECX
   157 00000162 25 000000FC                     	AND	EAX,252
   158 00000167 83 E3 02                        	AND	EBX,2
   159 0000016A 09 C2                           	OR	EDX,EAX
   160 0000016C 81 C3 00000CFC                  	ADD	EBX,3324
   161 00000172 81 CA 80000000                  	OR	EDX,-2147483648
   162 00000178 52                              	PUSH	EDX
   163 00000179 68 00000CF8                     	PUSH	3320
   164 0000017E E8 [00000000]                   	CALL	_io_out32
   165 00000183 53                              	PUSH	EBX
   166 00000184 0F BF 45 18                     	MOVSX	EAX,WORD [24+EBP]
   167 00000188 50                              	PUSH	EAX
   168 00000189 E8 [00000000]                   	CALL	_io_out16
   169 0000018E 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   170 00000191 31 C0                           	XOR	EAX,EAX
   171 00000193 C9                              	LEAVE
   172 00000194 C3                              	RET
   173 00000195                                 	GLOBAL	__pci_write_dword
   174 00000195                                 __pci_write_dword:
   175 00000195 55                              	PUSH	EBP
   176 00000196 89 E5                           	MOV	EBP,ESP
   177 00000198 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   178 0000019B 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   179 0000019E C1 E0 0B                        	SAL	EAX,11
   180 000001A1 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   181 000001A4 C1 E2 10                        	SAL	EDX,16
   182 000001A7 C1 E1 08                        	SAL	ECX,8
   183 000001AA 09 C2                           	OR	EDX,EAX
   184 000001AC 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   185 000001AF 09 CA                           	OR	EDX,ECX
   186 000001B1 25 000000FC                     	AND	EAX,252
   187 000001B6 09 C2                           	OR	EDX,EAX
   188 000001B8 81 CA 80000000                  	OR	EDX,-2147483648
   189 000001BE 52                              	PUSH	EDX
   190 000001BF 68 00000CF8                     	PUSH	3320
   191 000001C4 E8 [00000000]                   	CALL	_io_out32
   192 000001C9 68 00000CFC                     	PUSH	3324
   193 000001CE FF 75 18                        	PUSH	DWORD [24+EBP]
   194 000001D1 E8 [00000000]                   	CALL	_io_out32
   195 000001D6 31 C0                           	XOR	EAX,EAX
   196 000001D8 C9                              	LEAVE
   197 000001D9 C3                              	RET
   198 000001DA                                 	GLOBAL	_pci_read_byte
   199 000001DA                                 _pci_read_byte:
   200 000001DA 55                              	PUSH	EBP
   201 000001DB 89 E5                           	MOV	EBP,ESP
   202 000001DD 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   203 000001E0 FF 75 0C                        	PUSH	DWORD [12+EBP]
   204 000001E3 FF 70 10                        	PUSH	DWORD [16+EAX]
   205 000001E6 FF 70 0C                        	PUSH	DWORD [12+EAX]
   206 000001E9 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   207 000001EC FF 30                           	PUSH	DWORD [EAX]
   208 000001EE E8 FFFFFE0D                     	CALL	__pci_read_byte
   209 000001F3 C9                              	LEAVE
   210 000001F4 C3                              	RET
   211 000001F5                                 	GLOBAL	_pci_read_word
   212 000001F5                                 _pci_read_word:
   213 000001F5 55                              	PUSH	EBP
   214 000001F6 89 E5                           	MOV	EBP,ESP
   215 000001F8 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   216 000001FB FF 75 0C                        	PUSH	DWORD [12+EBP]
   217 000001FE FF 70 10                        	PUSH	DWORD [16+EAX]
   218 00000201 FF 70 0C                        	PUSH	DWORD [12+EAX]
   219 00000204 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   220 00000207 FF 30                           	PUSH	DWORD [EAX]
   221 00000209 E8 FFFFFE49                     	CALL	__pci_read_word
   222 0000020E C9                              	LEAVE
   223 0000020F C3                              	RET
   224 00000210                                 	GLOBAL	_pci_read_dword
   225 00000210                                 _pci_read_dword:
   226 00000210 55                              	PUSH	EBP
   227 00000211 89 E5                           	MOV	EBP,ESP
   228 00000213 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   229 00000216 FF 75 0C                        	PUSH	DWORD [12+EBP]
   230 00000219 FF 70 10                        	PUSH	DWORD [16+EAX]
   231 0000021C FF 70 0C                        	PUSH	DWORD [12+EAX]
   232 0000021F 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   233 00000222 FF 30                           	PUSH	DWORD [EAX]
   234 00000224 E8 FFFFFE85                     	CALL	__pci_read_dword
   235 00000229 C9                              	LEAVE
   236 0000022A C3                              	RET
   237 0000022B                                 	GLOBAL	_pci_write_byte
   238 0000022B                                 _pci_write_byte:
   239 0000022B 55                              	PUSH	EBP
   240 0000022C 89 E5                           	MOV	EBP,ESP
   241 0000022E FF 75 10                        	PUSH	DWORD [16+EBP]
   242 00000231 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   243 00000234 FF 75 0C                        	PUSH	DWORD [12+EBP]
   244 00000237 FF 70 10                        	PUSH	DWORD [16+EAX]
   245 0000023A FF 70 0C                        	PUSH	DWORD [12+EAX]
   246 0000023D 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   247 00000240 FF 30                           	PUSH	DWORD [EAX]
   248 00000242 E8 FFFFFEAA                     	CALL	__pci_write_byte
   249 00000247 31 C0                           	XOR	EAX,EAX
   250 00000249 C9                              	LEAVE
   251 0000024A C3                              	RET
   252 0000024B                                 	GLOBAL	_pci_write_word
   253 0000024B                                 _pci_write_word:
   254 0000024B 55                              	PUSH	EBP
   255 0000024C 89 E5                           	MOV	EBP,ESP
   256 0000024E FF 75 10                        	PUSH	DWORD [16+EBP]
   257 00000251 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   258 00000254 FF 75 0C                        	PUSH	DWORD [12+EBP]
   259 00000257 FF 70 10                        	PUSH	DWORD [16+EAX]
   260 0000025A FF 70 0C                        	PUSH	DWORD [12+EAX]
   261 0000025D 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   262 00000260 FF 30                           	PUSH	DWORD [EAX]
   263 00000262 E8 FFFFFEDC                     	CALL	__pci_write_word
   264 00000267 31 C0                           	XOR	EAX,EAX
   265 00000269 C9                              	LEAVE
   266 0000026A C3                              	RET
   267 0000026B                                 	GLOBAL	_pci_write_dword
   268 0000026B                                 _pci_write_dword:
   269 0000026B 55                              	PUSH	EBP
   270 0000026C 89 E5                           	MOV	EBP,ESP
   271 0000026E FF 75 10                        	PUSH	DWORD [16+EBP]
   272 00000271 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   273 00000274 FF 75 0C                        	PUSH	DWORD [12+EBP]
   274 00000277 FF 70 10                        	PUSH	DWORD [16+EAX]
   275 0000027A FF 70 0C                        	PUSH	DWORD [12+EAX]
   276 0000027D 8B 40 08                        	MOV	EAX,DWORD [8+EAX]
   277 00000280 FF 30                           	PUSH	DWORD [EAX]
   278 00000282 E8 FFFFFF0E                     	CALL	__pci_write_dword
   279 00000287 31 C0                           	XOR	EAX,EAX
   280 00000289 C9                              	LEAVE
   281 0000028A C3                              	RET
   282 0000028B                                 	GLOBAL	_pci_add_dev
   283 0000028B                                 _pci_add_dev:
   284 0000028B 55                              	PUSH	EBP
   285 0000028C 89 E5                           	MOV	EBP,ESP
   286 0000028E 56                              	PUSH	ESI
   287 0000028F 53                              	PUSH	EBX
   288 00000290 6A 7C                           	PUSH	124
   289 00000292 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   290 00000295 E8 [00000000]                   	CALL	_kalloc
   291 0000029A 89 C3                           	MOV	EBX,EAX
   292 0000029C 8B 46 08                        	MOV	EAX,DWORD [8+ESI]
   293 0000029F 89 43 08                        	MOV	DWORD [8+EBX],EAX
   294 000002A2 8B 46 0C                        	MOV	EAX,DWORD [12+ESI]
   295 000002A5 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   296 000002A8 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   297 000002AB 89 43 10                        	MOV	DWORD [16+EBX],EAX
   298 000002AE 8A 46 18                        	MOV	AL,BYTE [24+ESI]
   299 000002B1 88 43 18                        	MOV	BYTE [24+EBX],AL
   300 000002B4 6A 00                           	PUSH	0
   301 000002B6 FF 73 10                        	PUSH	DWORD [16+EBX]
   302 000002B9 FF 73 0C                        	PUSH	DWORD [12+EBX]
   303 000002BC 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   304 000002BF FF 30                           	PUSH	DWORD [EAX]
   305 000002C1 E8 FFFFFD91                     	CALL	__pci_read_word
   306 000002C6 66 89 43 14                     	MOV	WORD [20+EBX],AX
   307 000002CA 6A 02                           	PUSH	2
   308 000002CC FF 73 10                        	PUSH	DWORD [16+EBX]
   309 000002CF FF 73 0C                        	PUSH	DWORD [12+EBX]
   310 000002D2 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   311 000002D5 FF 30                           	PUSH	DWORD [EAX]
   312 000002D7 E8 FFFFFD7B                     	CALL	__pci_read_word
   313 000002DC 83 C4 24                        	ADD	ESP,36
   314 000002DF 66 89 43 16                     	MOV	WORD [22+EBX],AX
   315 000002E3 6A 08                           	PUSH	8
   316 000002E5 FF 73 10                        	PUSH	DWORD [16+EBX]
   317 000002E8 FF 73 0C                        	PUSH	DWORD [12+EBX]
   318 000002EB 8B 43 08                        	MOV	EAX,DWORD [8+EBX]
   319 000002EE FF 30                           	PUSH	DWORD [EAX]
   320 000002F0 E8 FFFFFDB9                     	CALL	__pci_read_dword
   321 000002F5 89 43 1C                        	MOV	DWORD [28+EBX],EAX
   322 000002F8 53                              	PUSH	EBX
   323 000002F9 68 [00000020]                   	PUSH	_pci_dev_list
   324 000002FE E8 [00000000]                   	CALL	_list_append
   325 00000303 89 D8                           	MOV	EAX,EBX
   326 00000305 FF 05 [00000004]                	INC	DWORD [_devnum]
   327 0000030B 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   328 0000030E 5B                              	POP	EBX
   329 0000030F 5E                              	POP	ESI
   330 00000310 5D                              	POP	EBP
   331 00000311 C3                              	RET
   332 00000312                                 	GLOBAL	_pci_check_func
   333 00000312                                 _pci_check_func:
   334 00000312 55                              	PUSH	EBP
   335 00000313 89 E5                           	MOV	EBP,ESP
   336 00000315 57                              	PUSH	EDI
   337 00000316 56                              	PUSH	ESI
   338 00000317 53                              	PUSH	EBX
   339 00000318 83 C4 80                        	ADD	ESP,-128
   340 0000031B 8B 5D 10                        	MOV	EBX,DWORD [16+EBP]
   341 0000031E 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   342 00000321 6A 0E                           	PUSH	14
   343 00000323 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   344 00000326 53                              	PUSH	EBX
   345 00000327 8B 04 BD [00000040]             	MOV	EAX,DWORD [_bus_list+EDI*4]
   346 0000032E 56                              	PUSH	ESI
   347 0000032F 89 85 FFFFFF7C                  	MOV	DWORD [-132+EBP],EAX
   348 00000335 57                              	PUSH	EDI
   349 00000336 89 75 80                        	MOV	DWORD [-128+EBP],ESI
   350 00000339 89 5D 84                        	MOV	DWORD [-124+EBP],EBX
   351 0000033C E8 FFFFFCBF                     	CALL	__pci_read_byte
   352 00000341 88 45 8C                        	MOV	BYTE [-116+EBP],AL
   353 00000344 8D 85 FFFFFF74                  	LEA	EAX,DWORD [-140+EBP]
   354 0000034A 50                              	PUSH	EAX
   355 0000034B E8 FFFFFF3B                     	CALL	_pci_add_dev
   356 00000350 6A 0A                           	PUSH	10
   357 00000352 53                              	PUSH	EBX
   358 00000353 56                              	PUSH	ESI
   359 00000354 57                              	PUSH	EDI
   360 00000355 E8 FFFFFCFD                     	CALL	__pci_read_word
   361 0000035A 83 C4 24                        	ADD	ESP,36
   362 0000035D 3D 00000604                     	CMP	EAX,1540
   363 00000362 74 08                           	JE	L16
   364 00000364                                 L14:
   365 00000364 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   366 00000367 5B                              	POP	EBX
   367 00000368 5E                              	POP	ESI
   368 00000369 5F                              	POP	EDI
   369 0000036A 5D                              	POP	EBP
   370 0000036B C3                              	RET
   371 0000036C                                 L16:
   372 0000036C 6A 19                           	PUSH	25
   373 0000036E 53                              	PUSH	EBX
   374 0000036F 56                              	PUSH	ESI
   375 00000370 57                              	PUSH	EDI
   376 00000371 E8 FFFFFC8A                     	CALL	__pci_read_byte
   377 00000376 83 C4 10                        	ADD	ESP,16
   378 00000379 50                              	PUSH	EAX
   379 0000037A E8 0000009B                     	CALL	_pci_scan_bus
   380 0000037F 59                              	POP	ECX
   381 00000380 EB E2                           	JMP	L14
   382 00000382                                 	GLOBAL	_pci_check_dev
   383 00000382                                 _pci_check_dev:
   384 00000382 55                              	PUSH	EBP
   385 00000383 89 E5                           	MOV	EBP,ESP
   386 00000385 57                              	PUSH	EDI
   387 00000386 56                              	PUSH	ESI
   388 00000387 53                              	PUSH	EBX
   389 00000388 8B 75 0C                        	MOV	ESI,DWORD [12+EBP]
   390 0000038B 6A 00                           	PUSH	0
   391 0000038D 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   392 00000390 6A 00                           	PUSH	0
   393 00000392 56                              	PUSH	ESI
   394 00000393 57                              	PUSH	EDI
   395 00000394 E8 FFFFFCBE                     	CALL	__pci_read_word
   396 00000399 83 C4 10                        	ADD	ESP,16
   397 0000039C 3D 0000FFFF                     	CMP	EAX,65535
   398 000003A1 74 12                           	JE	L17
   399 000003A3 6A 00                           	PUSH	0
   400 000003A5 6A 00                           	PUSH	0
   401 000003A7 56                              	PUSH	ESI
   402 000003A8 57                              	PUSH	EDI
   403 000003A9 E8 FFFFFCA9                     	CALL	__pci_read_word
   404 000003AE 83 C4 10                        	ADD	ESP,16
   405 000003B1 85 C0                           	TEST	EAX,EAX
   406 000003B3 75 08                           	JNE	L29
   407 000003B5                                 L17:
   408 000003B5 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   409 000003B8 5B                              	POP	EBX
   410 000003B9 5E                              	POP	ESI
   411 000003BA 5F                              	POP	EDI
   412 000003BB 5D                              	POP	EBP
   413 000003BC C3                              	RET
   414 000003BD                                 L29:
   415 000003BD 6A 0E                           	PUSH	14
   416 000003BF 6A 00                           	PUSH	0
   417 000003C1 56                              	PUSH	ESI
   418 000003C2 57                              	PUSH	EDI
   419 000003C3 E8 FFFFFC38                     	CALL	__pci_read_byte
   420 000003C8 83 C4 10                        	ADD	ESP,16
   421 000003CB 83 E0 01                        	AND	EAX,1
   422 000003CE 74 3C                           	JE	L20
   423 000003D0 31 DB                           	XOR	EBX,EBX
   424 000003D2                                 L26:
   425 000003D2 6A 00                           	PUSH	0
   426 000003D4 53                              	PUSH	EBX
   427 000003D5 56                              	PUSH	ESI
   428 000003D6 57                              	PUSH	EDI
   429 000003D7 E8 FFFFFC7B                     	CALL	__pci_read_word
   430 000003DC 83 C4 10                        	ADD	ESP,16
   431 000003DF 3D 0000FFFF                     	CMP	EAX,65535
   432 000003E4 74 11                           	JE	L23
   433 000003E6 6A 00                           	PUSH	0
   434 000003E8 53                              	PUSH	EBX
   435 000003E9 56                              	PUSH	ESI
   436 000003EA 57                              	PUSH	EDI
   437 000003EB E8 FFFFFC67                     	CALL	__pci_read_word
   438 000003F0 83 C4 10                        	ADD	ESP,16
   439 000003F3 85 C0                           	TEST	EAX,EAX
   440 000003F5 75 08                           	JNE	L30
   441 000003F7                                 L23:
   442 000003F7 43                              	INC	EBX
   443 000003F8 83 FB 07                        	CMP	EBX,7
   444 000003FB 7E D5                           	JLE	L26
   445 000003FD EB B6                           	JMP	L17
   446 000003FF                                 L30:
   447 000003FF 53                              	PUSH	EBX
   448 00000400 56                              	PUSH	ESI
   449 00000401 57                              	PUSH	EDI
   450 00000402 E8 FFFFFF0B                     	CALL	_pci_check_func
   451 00000407 83 C4 0C                        	ADD	ESP,12
   452 0000040A EB EB                           	JMP	L23
   453 0000040C                                 L20:
   454 0000040C 6A 00                           	PUSH	0
   455 0000040E 56                              	PUSH	ESI
   456 0000040F 57                              	PUSH	EDI
   457 00000410 E8 FFFFFEFD                     	CALL	_pci_check_func
   458 00000415 83 C4 0C                        	ADD	ESP,12
   459 00000418 EB 9B                           	JMP	L17
   460 0000041A                                 	GLOBAL	_pci_scan_bus
   461 0000041A                                 _pci_scan_bus:
   462 0000041A 55                              	PUSH	EBP
   463 0000041B 89 E5                           	MOV	EBP,ESP
   464 0000041D 56                              	PUSH	ESI
   465 0000041E 53                              	PUSH	EBX
   466 0000041F 31 DB                           	XOR	EBX,EBX
   467 00000421 83 EC 30                        	SUB	ESP,48
   468 00000424 8D 45 C8                        	LEA	EAX,DWORD [-56+EBP]
   469 00000427 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   470 0000042A 89 75 C8                        	MOV	DWORD [-56+EBP],ESI
   471 0000042D 89 75 D0                        	MOV	DWORD [-48+EBP],ESI
   472 00000430 89 75 CC                        	MOV	DWORD [-52+EBP],ESI
   473 00000433 89 04 B5 [00000040]             	MOV	DWORD [_bus_list+ESI*4],EAX
   474 0000043A                                 L36:
   475 0000043A 53                              	PUSH	EBX
   476 0000043B 43                              	INC	EBX
   477 0000043C 56                              	PUSH	ESI
   478 0000043D E8 FFFFFF40                     	CALL	_pci_check_dev
   479 00000442 83 FB 1F                        	CMP	EBX,31
   480 00000445 58                              	POP	EAX
   481 00000446 5A                              	POP	EDX
   482 00000447 7E F1                           	JLE	L36
   483 00000449 FF 05 [00000000]                	INC	DWORD [_busnum]
   484 0000044F 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   485 00000452 5B                              	POP	EBX
   486 00000453 5E                              	POP	ESI
   487 00000454 5D                              	POP	EBP
   488 00000455 C3                              	RET
   489 00000456                                 	GLOBAL	_pci_probe
   490 00000456                                 _pci_probe:
   491 00000456 55                              	PUSH	EBP
   492 00000457 89 E5                           	MOV	EBP,ESP
   493 00000459 6A 00                           	PUSH	0
   494 0000045B 6A 00                           	PUSH	0
   495 0000045D 6A 00                           	PUSH	0
   496 0000045F 6A 00                           	PUSH	0
   497 00000461 E8 FFFFFC48                     	CALL	__pci_read_dword
   498 00000466 83 C4 10                        	ADD	ESP,16
   499 00000469 40                              	INC	EAX
   500 0000046A 0F 95 C0                        	SETNE	AL
   501 0000046D 0F B6 C0                        	MOVZX	EAX,AL
   502 00000470 C9                              	LEAVE
   503 00000471 C3                              	RET
   504 00000472                                 	GLOBAL	_pci_init
   505 00000472                                 _pci_init:
   506 00000472 55                              	PUSH	EBP
   507 00000473 89 E5                           	MOV	EBP,ESP
   508 00000475 E8 FFFFFFDC                     	CALL	_pci_probe
   509 0000047A 31 D2                           	XOR	EDX,EDX
   510 0000047C 85 C0                           	TEST	EAX,EAX
   511 0000047E 75 04                           	JNE	L43
   512 00000480                                 L41:
   513 00000480 89 D0                           	MOV	EAX,EDX
   514 00000482 C9                              	LEAVE
   515 00000483 C3                              	RET
   516 00000484                                 L43:
   517 00000484 68 [00000030]                   	PUSH	_pci_bus_list
   518 00000489 E8 [00000000]                   	CALL	_list_init
   519 0000048E 68 [00000020]                   	PUSH	_pci_dev_list
   520 00000493 E8 [00000000]                   	CALL	_list_init
   521 00000498 6A 00                           	PUSH	0
   522 0000049A E8 FFFFFF7B                     	CALL	_pci_scan_bus
   523 0000049F BA 00000001                     	MOV	EDX,1
   524 000004A4 EB DA                           	JMP	L41
   525                                          [SECTION .data]
   526 00000008                                 LC0:
   527 00000008 25 34 78 20 25 34 78 20 25 64   	DB	"%4x %4x %d %d %d",0x0A,0x00
       00000012 20 25 64 20 25 64 0A 00 
   528                                          [SECTION .text]
   529 000004A6                                 	GLOBAL	_pci_test_f
   530 000004A6                                 _pci_test_f:
   531 000004A6 55                              	PUSH	EBP
   532 000004A7 89 E5                           	MOV	EBP,ESP
   533 000004A9 53                              	PUSH	EBX
   534 000004AA 81 EC 000003F0                  	SUB	ESP,1008
   535 000004B0 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   536 000004B3 8D 9D FFFFFC0C                  	LEA	EBX,DWORD [-1012+EBP]
   537 000004B9 FF 72 10                        	PUSH	DWORD [16+EDX]
   538 000004BC FF 72 0C                        	PUSH	DWORD [12+EDX]
   539 000004BF 8B 42 08                        	MOV	EAX,DWORD [8+EDX]
   540 000004C2 FF 30                           	PUSH	DWORD [EAX]
   541 000004C4 0F BF 42 16                     	MOVSX	EAX,WORD [22+EDX]
   542 000004C8 50                              	PUSH	EAX
   543 000004C9 0F BF 42 14                     	MOVSX	EAX,WORD [20+EDX]
   544 000004CD 50                              	PUSH	EAX
   545 000004CE 68 [00000008]                   	PUSH	LC0
   546 000004D3 53                              	PUSH	EBX
   547 000004D4 E8 [00000000]                   	CALL	_sprintf
   548 000004D9 53                              	PUSH	EBX
   549 000004DA FF 75 0C                        	PUSH	DWORD [12+EBP]
   550 000004DD E8 [00000000]                   	CALL	_cons_putstr0
   551 000004E2 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   552 000004E5 31 C0                           	XOR	EAX,EAX
   553 000004E7 C9                              	LEAVE
   554 000004E8 C3                              	RET
   555                                          [SECTION .data]
   556 0000001A                                 LC1:
   557 0000001A 25 64 0A 0A 00                  	DB	"%d",0x0A,0x0A,0x00
   558                                          [SECTION .text]
   559 000004E9                                 	GLOBAL	_pci_test
   560 000004E9                                 _pci_test:
   561 000004E9 55                              	PUSH	EBP
   562 000004EA 89 E5                           	MOV	EBP,ESP
   563 000004EC 56                              	PUSH	ESI
   564 000004ED 53                              	PUSH	EBX
   565 000004EE 83 EC 70                        	SUB	ESP,112
   566 000004F1 8D 5D 88                        	LEA	EBX,DWORD [-120+EBP]
   567 000004F4 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
   568 000004F7 56                              	PUSH	ESI
   569 000004F8 68 [000004A6]                   	PUSH	_pci_test_f
   570 000004FD 68 [00000020]                   	PUSH	_pci_dev_list
   571 00000502 E8 [00000000]                   	CALL	_list_traversal
   572 00000507 FF 35 [00000000]                	PUSH	DWORD [_busnum]
   573 0000050D 68 [0000001A]                   	PUSH	LC1
   574 00000512 53                              	PUSH	EBX
   575 00000513 E8 [00000000]                   	CALL	_sprintf
   576 00000518 53                              	PUSH	EBX
   577 00000519 56                              	PUSH	ESI
   578 0000051A E8 [00000000]                   	CALL	_cons_putstr0
   579 0000051F 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
   580 00000522 5B                              	POP	EBX
   581 00000523 5E                              	POP	ESI
   582 00000524 5D                              	POP	EBP
   583 00000525 C3                              	RET
   584 00000526                                 	GLOBAL	_PCIEntry
   585 00000526                                 _PCIEntry:
   586 00000526 55                              	PUSH	EBP
   587 00000527 89 E5                           	MOV	EBP,ESP
   588 00000529 E8 FFFFFF44                     	CALL	_pci_init
   589 0000052E 5D                              	POP	EBP
   590 0000052F B8 00000001                     	MOV	EAX,1
   591 00000534 C3                              	RET
   592 00000535                                 	GLOBAL	_pci_dev_list
   593                                          [SECTION .data]
   594 0000001F 00                              	ALIGNB	16
   595 00000020                                 _pci_dev_list:
   596 00000020 00 00 00 00 00 00 00 00 00 00   	RESB	16
       0000002A 00 00 00 00 00 00 
   597 00000030                                 	GLOBAL	_pci_bus_list
   598                                          [SECTION .data]
   599 00000030                                 	ALIGNB	16
   600 00000030                                 _pci_bus_list:
   601 00000030 00 00 00 00 00 00 00 00 00 00   	RESB	16
       0000003A 00 00 00 00 00 00 
   602 00000040                                 	GLOBAL	_bus_list
   603                                          [SECTION .data]
   604 00000040                                 	ALIGNB	16
   605 00000040                                 _bus_list:
   606 00000040 00 00 00 00 00 00 00 00 00 00   	RESB	1024
       0000004A 00 00 00 00 00 00 00 00 00 00 
       00000054 00 00 00 00 00 00 00 00 00 00 
       0000005E 00 00 00 00 00 00 00 00 00 00 
       00000068 00 00 00 00 00 00 00 00 00 00 
       00000072 00 00 00 00 00 00 00 00 00 00 
       0000007C 00 00 00 00 00 00 00 00 00 00 
       00000086 00 00 00 00 00 00 00 00 00 00 
       00000090 00 00 00 00 00 00 00 00 00 00 
       0000009A 00 00 00 00 00 00 00 00 00 00 
       000000A4 00 00 00 00 00 00 00 00 00 00 
       000000AE 00 00 00 00 00 00 00 00 00 00 
       000000B8 00 00 00 00 00 00 00 00 00 00 
       000000C2 00 00 00 00 00 00 00 00 00 00 
       000000CC 00 00 00 00 00 00 00 00 00 00 
       000000D6 00 00 00 00 00 00 00 00 00 00 
       000000E0 00 00 00 00 00 00 00 00 00 00 
       000000EA 00 00 00 00 00 00 00 00 00 00 
       000000F4 00 00 00 00 00 00 00 00 00 00 
       000000FE 00 00 00 00 00 00 00 00 00 00 
       00000108 00 00 00 00 00 00 00 00 00 00 
       00000112 00 00 00 00 00 00 00 00 00 00 
       0000011C 00 00 00 00 00 00 00 00 00 00 
       00000126 00 00 00 00 00 00 00 00 00 00 
       00000130 00 00 00 00 00 00 00 00 00 00 
       0000013A 00 00 00 00 00 00 00 00 00 00 
       00000144 00 00 00 00 00 00 00 00 00 00 
       0000014E 00 00 00 00 00 00 00 00 00 00 
       00000158 00 00 00 00 00 00 00 00 00 00 
       00000162 00 00 00 00 00 00 00 00 00 00 
       0000016C 00 00 00 00 00 00 00 00 00 00 
       00000176 00 00 00 00 00 00 00 00 00 00 
       00000180 00 00 00 00 00 00 00 00 00 00 
       0000018A 00 00 00 00 00 00 00 00 00 00 
       00000194 00 00 00 00 00 00 00 00 00 00 
       0000019E 00 00 00 00 00 00 00 00 00 00 
       000001A8 00 00 00 00 00 00 00 00 00 00 
       000001B2 00 00 00 00 00 00 00 00 00 00 
       000001BC 00 00 00 00 00 00 00 00 00 00 
       000001C6 00 00 00 00 00 00 00 00 00 00 
       000001D0 00 00 00 00 00 00 00 00 00 00 
       000001DA 00 00 00 00 00 00 00 00 00 00 
       000001E4 00 00 00 00 00 00 00 00 00 00 
       000001EE 00 00 00 00 00 00 00 00 00 00 
       000001F8 00 00 00 00 00 00 00 00 00 00 
       00000202 00 00 00 00 00 00 00 00 00 00 
       0000020C 00 00 00 00 00 00 00 00 00 00 
       00000216 00 00 00 00 00 00 00 00 00 00 
       00000220 00 00 00 00 00 00 00 00 00 00 
       0000022A 00 00 00 00 00 00 00 00 00 00 
       00000234 00 00 00 00 00 00 00 00 00 00 
       0000023E 00 00 00 00 00 00 00 00 00 00 
       00000248 00 00 00 00 00 00 00 00 00 00 
       00000252 00 00 00 00 00 00 00 00 00 00 
       0000025C 00 00 00 00 00 00 00 00 00 00 
       00000266 00 00 00 00 00 00 00 00 00 00 
       00000270 00 00 00 00 00 00 00 00 00 00 
       0000027A 00 00 00 00 00 00 00 00 00 00 
       00000284 00 00 00 00 00 00 00 00 00 00 
       0000028E 00 00 00 00 00 00 00 00 00 00 
       00000298 00 00 00 00 00 00 00 00 00 00 
       000002A2 00 00 00 00 00 00 00 00 00 00 
       000002AC 00 00 00 00 00 00 00 00 00 00 
       000002B6 00 00 00 00 00 00 00 00 00 00 
       000002C0 00 00 00 00 00 00 00 00 00 00 
       000002CA 00 00 00 00 00 00 00 00 00 00 
       000002D4 00 00 00 00 00 00 00 00 00 00 
       000002DE 00 00 00 00 00 00 00 00 00 00 
       000002E8 00 00 00 00 00 00 00 00 00 00 
       000002F2 00 00 00 00 00 00 00 00 00 00 
       000002FC 00 00 00 00 00 00 00 00 00 00 
       00000306 00 00 00 00 00 00 00 00 00 00 
       00000310 00 00 00 00 00 00 00 00 00 00 
       0000031A 00 00 00 00 00 00 00 00 00 00 
       00000324 00 00 00 00 00 00 00 00 00 00 
       0000032E 00 00 00 00 00 00 00 00 00 00 
       00000338 00 00 00 00 00 00 00 00 00 00 
       00000342 00 00 00 00 00 00 00 00 00 00 
       0000034C 00 00 00 00 00 00 00 00 00 00 
       00000356 00 00 00 00 00 00 00 00 00 00 
       00000360 00 00 00 00 00 00 00 00 00 00 
       0000036A 00 00 00 00 00 00 00 00 00 00 
       00000374 00 00 00 00 00 00 00 00 00 00 
       0000037E 00 00 00 00 00 00 00 00 00 00 
       00000388 00 00 00 00 00 00 00 00 00 00 
       00000392 00 00 00 00 00 00 00 00 00 00 
       0000039C 00 00 00 00 00 00 00 00 00 00 
       000003A6 00 00 00 00 00 00 00 00 00 00 
       000003B0 00 00 00 00 00 00 00 00 00 00 
       000003BA 00 00 00 00 00 00 00 00 00 00 
       000003C4 00 00 00 00 00 00 00 00 00 00 
       000003CE 00 00 00 00 00 00 00 00 00 00 
       000003D8 00 00 00 00 00 00 00 00 00 00 
       000003E2 00 00 00 00 00 00 00 00 00 00 
       000003EC 00 00 00 00 00 00 00 00 00 00 
       000003F6 00 00 00 00 00 00 00 00 00 00 
       00000400 00 00 00 00 00 00 00 00 00 00 
       0000040A 00 00 00 00 00 00 00 00 00 00 
       00000414 00 00 00 00 00 00 00 00 00 00 
       0000041E 00 00 00 00 00 00 00 00 00 00 
       00000428 00 00 00 00 00 00 00 00 00 00 
       00000432 00 00 00 00 00 00 00 00 00 00 
       0000043C 00 00 00 00 
